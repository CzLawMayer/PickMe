@import "tailwindcss";
@import "tw-animate-css";

html, body { height: 100%; }
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  background: var(--bg);
  color: var(--fg);
  font-family: Arial, Helvetica, sans-serif;
}
.app {
  display: flex;
  flex-direction: column;
  height: 100vh;
}
.logo { font-size: 28px; font-weight: 800; letter-spacing: .5px; }
.logo span { color: #bfbfbf; }
.carousel {
  position: relative;
  flex: 1;
  min-height: calc(var(--book-h) + 120px);
  overflow: hidden;
}
.drag-layer {
  position: absolute;
  inset: 0;
  touch-action: pan-y;
  cursor: grab;
  user-select: none;
  will-change: transform;
  z-index: 2;
  transition: transform 480ms cubic-bezier(.22, .61, .36, 1);
}
.drag-layer.dragging {
  transition: none !important;
  cursor: grabbing;
}
.drag-layer.animating {
  transition: transform 480ms cubic-bezier(.22, .61, .36, 1);
}
.vertical-arrows {
  position: absolute;
  top: 45%;
  left: calc(50% + (var(--book-w) / 2) + var(--arrow-gap));
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 35px;
  z-index: 4;
}
.arrow {
  appearance: none;
  border: none;
  background: #1f1f1f;
  color: #fff;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: grid;
  place-items: center;
  font-size: 24px;
  line-height: 1;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 2px 6px rgba(0,0,0,.35);
  transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
}
.arrow:hover { transform: translateY(-1px); box-shadow: 0 4px 10px rgba(0,0,0,.4); }
.arrow:active { transform: translateY(0); box-shadow: 0 2px 6px rgba(0,0,0,.35); }
.user-icon { font-size: 28px; margin-bottom: 8px; }
.username { font-weight: bold; margin: 4px 0 12px; }
.icons div { margin: 6px 0; }
.chapters {
  border-top: 1px solid #fff;
  margin-top: 10px;
  padding-top: 10px;
  max-width: 180px;
}
.tags span { display: block; margin: 6px 0; }
.book-placeholder {
  width: 100%;
  height: 100%;
  background: #2d2d2d;
  display: grid;
  place-items: center;
  font-size: 14px;
  letter-spacing: 2px;
}
.left-book  { left: calc(50% - (var(--book-w) * 1.5) - var(--side-gap)); }
.right-book { left: calc(50% + (var(--book-w) * 0.5) + var(--side-gap)); }
.left-off-1  { left: calc(50% - (var(--book-w) * 2.5) - (var(--side-gap) * 2)); opacity: .001; pointer-events: none; }
.right-off-1 { left: calc(50% + (var(--book-w) * 1.5) + (var(--side-gap) * 2)); opacity: .001; pointer-events: none; }
.drag-layer.dragging .book.main-book {
  transform: translate(-50%, -50%) scale(1.00);
}
@media (max-width: 1250px) {
  :root {
    --book-w: 380px;
    --book-h: 540px;
    --meta-w: 200px;
  }
}
.material-symbols-outlined {
  font-family: "Material Symbols Outlined", sans-serif;
  font-weight: normal;
  font-style: normal;
  font-size: 1em;
  line-height: 1;
  display: inline-block;
  letter-spacing: normal;
  text-transform: none;
  white-space: nowrap;
  direction: ltr;
  -webkit-font-smoothing: antialiased;
  font-variation-settings:
    'FILL' var(--ms-fill, 0),
    'wght' var(--ms-wght, 400),
    'GRAD' 0,
    'opsz' var(--ms-opsz, 48);
}
.metadata{
  position: absolute;
  top: 45%;
  transform: translateY(-50%);
  left: calc(50% - var(--book-w) - var(--meta-gap));
  width: var(--meta-w);
  height: var(--meta-h);
  color: var(--fg);
  z-index: 3;
  display: block;
}
.meta-header{
  display: grid;
  grid-template-columns: var(--meta-avatar-ring) 1fr;
  column-gap: 10px;
  align-items: center;
  height: var(--meta-header-h);
  margin-bottom: 10px;
  overflow: hidden;
}
.meta-avatar{
  width: var(--meta-avatar-ring);
  height: var(--meta-avatar-ring);
  border-radius: 999px;
  border: 3px solid var(--fg);
  display: grid;
  place-items: center;
}
.meta-avatar svg{
  width: var(--meta-avatar-glyph);
  height: var(--meta-avatar-glyph);
  display: block;
}
.meta-username{
  display: flex;
  align-items: center;
  height: 100%;
  font-weight: 700;
  font-size: var(--meta-name-size);
  line-height: 1.15;
  white-space: normal;
  overflow: hidden;
  max-height: calc(1.15em * 2);
}
.meta-hr{
  border: none;
  border-top: var(--meta-divider) solid rgba(255,255,255,.95);
  margin: 10px 0 12px;
}
.meta-actions{
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  column-gap: 0;
  align-items: start;
  margin-bottom: 2px;
  width: 100%;
}
.meta-actions .meta-icon-btn:nth-child(1){ justify-self: start; }
.meta-actions .meta-icon-btn:nth-child(2){ justify-self: center; }
.meta-actions .meta-icon-btn:nth-child(3){ justify-self: end; }
.meta-icon-glyph{
  font-size: var(--meta-glyph-size);
  --ms-opsz: 48;
  --ms-wght: 250;
  --ms-fill: 0;
  line-height: 1;
}
.meta-icon-btn.is-active .meta-icon-glyph{ --ms-fill: 1; --ms-wght: 400; }
.meta-icon-count{
  font-size: var(--meta-count-size);
  line-height: 1;
  opacity: .95;
}
.meta-chapters{
  font-size: 18px;
  font-weight: 800;
  letter-spacing: .2px;
  padding: 2px 0 6px;
}
.meta-tags{
  list-style: none;
  margin: 6px 0 0;
  padding: 0;
  display: block;
}
.meta-tags li{
  font-size: 18px;
  line-height: 1.25;
  margin: 6px 0;
  white-space: normal;
  word-break: break-word;
}
@media (max-width: 1000px){
  .metadata{ display: none; }
}
.meta-icon-btn:hover .meta-icon-glyph {
  transform: scale(1.15);
  transition: transform 120ms ease;
}
.meta-icon-btn:active .meta-icon-glyph { transform: scale(0.95); }
.meta-icon-btn.is-active.like .meta-icon-glyph { --ms-fill: 1; color: #d81b60; }
.meta-icon-btn.is-active.save .meta-icon-glyph { --ms-fill: 1; color: #6a1b9a; }
.meta-icon-btn { outline: none; }
.star-popover {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translate(-50%, -8px);
  background: rgba(20, 20, 20, 0.95);
  border: 1px solid rgba(255,255,255,.2);
  border-radius: 10px;
  padding: 8px 10px;
  box-shadow: 0 8px 22px rgba(0,0,0,.45);
  z-index: 10;
  min-width: 160px;
}
.star-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.star-item {
  appearance: none;
  background: transparent;
  border: none;
  padding: 4px;
  cursor: pointer;
  line-height: 1;
  border-radius: 6px;
  transition: transform 100ms ease;
}
.star-item:hover { transform: scale(1.1); }
.star-hint {
  text-align: center;
  font-size: 12px;
  opacity: .85;
  margin-top: 6px;
}
.meta-icon-btn.is-active.star .meta-icon-glyph { --ms-fill: 1; color: #f2ac15; }
.meta-icon-btn, .star-item {
  outline: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}
.menu-emoji{ font-size: 26px; display: grid; place-items: center; }
.menu-close{
  background: transparent;
  border: none;
  color: #fff;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  justify-self: end;
  -webkit-tap-highlight-color: transparent;
}
.item-profile  { border-left: 10px solid #ff8a00; }
.item-library  { border-left: 10px solid #8b4bff; }
.item-submit   { border-left: 10px solid #ff36a3; }
.item-logout   { border-left: 10px solid #29a3ff; }
.menu-burger i {
  display: block;
  width: 24px; height: 4px; border-radius: 3px;
  background: #ff6b6b;
}
.menu-burger i:nth-child(2){ background:#7b61ff; }
.menu-burger i:nth-child(3){ background:#28a9ff; }
.header,
.carousel,
.metadata,
.vertical-arrows,
.meta-actions,
.side-menu,
.menu-header,
.menu-list {
  user-select: none;
}
.icon,
.icon-menu,
.arrow,
.menu-close,
.menu-item,
.meta-icon-btn {
  outline: none;
}
.icon:focus,
.icon-menu:focus,
.arrow:focus,
.menu-close:focus,
.menu-item:focus,
.meta-icon-btn:focus {
  outline: none;
  box-shadow: none;
}
.icon-menu:focus-visible,
.arrow:focus-visible,
.menu-close:focus-visible,
.menu-item:focus-visible,
.meta-icon-btn:focus-visible {
  outline: none;
  box-shadow: none;
}
.carousel:focus,
.carousel:focus-visible {
  outline: none;
  box-shadow: none;
}
:root{
  --header-icon-size: 22px;
  --header-btn: 40px;
  --header-gap: 12px;
}
.header-icons{
  display: grid;
  grid-auto-flow: column;
  align-items: center;
  gap: var(--header-gap);
}
.icon-btn{
  display: inline-grid;
  place-items: center;
  width: var(--header-btn);
  height: var(--header-btn);
  font-size: var(--header-icon-size);
  line-height: 1;
  border: none;
  background: transparent;
  color: inherit;
  border-radius: 8px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}
.icon-btn:focus,
.icon-btn:focus-visible{ outline: none; box-shadow: none; }
.icon-menu.duplicate { }
.icon-close{ background: rgba(255,255,255,0.06); }
.icon-btn.panel-trigger{
  width: var(--header-btn);
  height: var(--header-btn);
  font-size: var(--header-icon-size);
}
.menu-title-wrap{
  display: grid;
  grid-template-rows: auto auto;
  align-items: center;
  justify-items: center;
}
.menu-subicons{
  display: grid;
  grid-auto-flow: column;
  gap: 8px;
  margin-top: 4px;
}
.menu-subicons .icon-btn{
  --header-btn: 32px;
  --header-icon-size: 18px;
}
.menu-spacer{ width: var(--header-btn); height: var(--header-btn); }
:root {
  --panel-header-h: 64px;
}
.menu-burger {
  display: grid;
  place-items: center;
  height: 100%;
}
:root {
  --app-header-h: 64px;
}
.header-icons .icon.icon-menu[aria-expanded="true"] {
  position: static !important;
  width: var(--header-btn) !important;
  height: var(--header-btn) !important;
}
:root {
  --app-header-h: 64px;
}
.header {
  height: var(--app-header-h);
  display: flex;
  align-items: center;
  padding: 0 28px;
  position: relative;
  z-index: 900;
}
.header-icons .icon:not(.icon-menu) {
  position: relative;
  z-index: 905;
}
.header-icons .icon.icon-menu {
  position: relative;
  z-index: 1000 !important;
  pointer-events: auto;
}
.menu-overlay { z-index: 950 !important; }
.side-menu    { z-index: 960 !important; }
.icon.icon-menu {
  width: var(--header-btn);
  height: var(--header-btn);
  display: grid;
  place-items: center;
  font-size: var(--header-icon-size);
}


.menu-header {
  height: var(--app-header-h);
  min-height: var(--panel-row-h);

  padding: 0 16px;
  display: grid;
  grid-template-columns: 64px 1fr; 
  align-items: center;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}

.menu-header .menu-emoji {
  display: grid;
  place-items: center;
  font-size: 34px;  
  height: 100%;
}

.menu-header .menu-title {
  font-size: 26px;   
  font-weight: 900;
  letter-spacing: .2px;
  display: flex;
  align-items: center;       
  justify-content: flex-start; 
  text-align: left;
}


.menu-item.fill { position: relative; }

.menu-item.fill:hover {
  transform: translateY(-1px);  
}

.menu-item.fill:hover::after {
  content: "";
  position: absolute;
  left: 0; right: 0;
  bottom: -1px;
  height: 1px;
  background: inherit;          
  pointer-events: none;
}





.book-front .book-placeholder {
  background: #2d2d2d; 
}
.book-front .book-placeholder[style*="url("] {
  background-color: transparent;
}

.book-back .book-placeholder.back {
  background: #232323;
  display: grid;
  place-items: center;
  letter-spacing: 2px;
  font-size: 14px;
  opacity: 1;
}

.book-inner.is-animating {
  --flip-cushion: 10px;
}

.drag-layer .book-inner {
  pointer-events: auto;
}

.carousel.is-flipping {
  position: relative;
  z-index: 1000;
  overflow: visible !important;
}
.carousel.is-flipping .book.main-book {
  overflow: visible;
  position: relative;
  z-index: 1001;
}

.book-inner,
.book-face,
.book-placeholder {
  outline: none !important;
  box-shadow: none !important;
}

.book-inner:focus,
.book-inner:focus-visible,
.book-face:focus,
.book-face:focus-visible,
.book-placeholder:focus,
.book-placeholder:focus-visible {
  outline: none !important;
  box-shadow: none !important;
}











.book-inner.is-open { opacity: 0; pointer-events: none; }

.book.main-book { overflow: visible; position: relative; z-index: 905; }

.face-fill {
  width: 100%;
  height: 100%;
  background: #2d2d2d;
  color: #fff;
  display: grid;
  place-items: center;
  font-size: 14px;
  letter-spacing: 2px;
}

.spread {
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(var(--book-w) * 2);
  height: var(--book-h);
  transform: translate(-50%, -50%);
  display: grid;
  grid-template-columns: var(--book-w) var(--book-w);
  gap: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 280ms ease;
  z-index: 1002;
  perspective: 1200px;
  -webkit-perspective: 1200px;
}

.spread .pane {
  width: var(--book-w);
  height: var(--book-h);
  background: #2d2d2d;
  color: #fff;
  display: grid;
  place-items: center;
  transform-style: preserve-3d;
}

.spread.will-open {
  opacity: 0;
  transform: translate(calc(-50% + (var(--book-w) / 2)), -50%);
}
.spread.will-open .pane.left  { transform: rotateY(0deg); }
.spread.will-open .pane.right { transform: rotateY(-180deg); }

@keyframes rightPageUnfold {
  from { transform: rotateY(-180deg); }
  to   { transform: rotateY(0deg); }
}
@keyframes slideSpreadCenter {
  from { transform: translate(calc(-50% + (var(--book-w) / 2)), -50%); }
  to   { transform: translate(-50%, -50%); }
}

.book .book-inner {
  background: transparent !important;
  border-radius: 0px;
}
.book .book-inner.is-flipped {
  background: #2d2d2d !important; 
}


.spread.is-open {
  opacity: 1;
  pointer-events: auto;
  animation: slideSpreadCenter 380ms cubic-bezier(.22,.61,.36,1) forwards; 
}

.spread.is-open .pane.right {
  animation: rightPageUnfold 420ms cubic-bezier(.22,.61,.36,1) 380ms forwards; 
}
.spread.is-open .pane.left {
  transform: rotateY(0deg);
}

.carousel.is-opening .spread {
  opacity: 1 !important;
  transition: none !important;          
  will-change: transform;                
}

.carousel.is-opening .spread.is-open {
  opacity: 1 !important;
}

.carousel.is-opening .book-inner {
  transition: transform 600ms cubic-bezier(.22,.61,.36,1) !important;
}
.carousel.is-opening .book-inner.is-open {
  opacity: 0 !important;                
}

.metadata,
.vertical-arrows {
  transition: left 380ms cubic-bezier(.22,.61,.36,1);
  will-change: left;
}

.carousel.is-opening .metadata {
  left: calc(50% - (var(--book-w) * 1.5) - var(--meta-gap));
}

.carousel.is-opening .vertical-arrows {
  left: calc(50% + var(--book-w) + var(--arrow-gap));
}



.book {
  transition:
    left 500ms cubic-bezier(.25,.8,.25,1),
    transform 500ms cubic-bezier(.25,.8,.25,1),
    box-shadow 300ms ease,
    opacity 300ms ease;
  will-change: left, transform, opacity;
}

.carousel.is-opening .book.left-book {
  left: calc(50% - (var(--book-w) * 3) - (var(--side-gap) * 2));
  opacity: 0;
  pointer-events: none;
}

.carousel.is-opening .book.right-book {
  left: calc(50% + (var(--book-w) * 2) + (var(--side-gap) * 2));
  opacity: 0;
  pointer-events: none;
}

.carousel.is-opening .book.left-off-1,
.carousel.is-opening .book.right-off-1 {
  opacity: 0;
  pointer-events: none;
}





.spread .page-content {
  font-size: 28px;
  font-weight: 800;
  opacity: .9;
}

.spread .pane.left  { transform-origin: right center; }
.spread .pane.right { transform-origin: left  center; }

.spread.turning-right .pane,
.spread.turning-left  .pane {
  transition: none !important;
}

.spread.turning-right .pane.right {
  z-index: 5;
  will-change: transform;
  transform: rotateY(-180deg) !important;
  animation: pageTurnNext 420ms cubic-bezier(.22,.61,.36,1) forwards !important;
}

.spread.turning-left .pane.left {
  z-index: 5;
  will-change: transform;
  transform: rotateY(180deg) !important;
  animation: pageTurnPrev 420ms cubic-bezier(.22,.61,.36,1) forwards !important;
}

.carousel.is-opening .spread.is-open .pane.right {
  animation: rightPageUnfold 420ms cubic-bezier(.22,.61,.36,1) forwards;
}
.carousel.is-opening .spread.is-open .pane.left {
  transform: rotateY(0deg);
}



.spread.turning-right .pane.right,
.spread.turning-left  .pane.left {
  animation: none !important;
  transform: rotateY(0deg) !important;
}


.carousel.is-opening .metadata,
.carousel.is-opened  .metadata {
  left: calc(50% - (var(--book-w) * 1.5) - var(--meta-gap));
}

.carousel.is-opening .book.left-book,
.carousel.is-opened  .book.left-book {
  left: calc(50% - (var(--book-w) * 3) - (var(--side-gap) * 2));
  opacity: 0;
  pointer-events: none;
}

.carousel.is-opening .book.right-book,
.carousel.is-opened  .book.right-book {
  left: calc(50% + (var(--book-w) * 2) + (var(--side-gap) * 2));
  opacity: 0;
  pointer-events: none;
}

.carousel.is-opening .book.left-off-1,
.carousel.is-opened  .book.left-off-1,
.carousel.is-opening .book.right-off-1,
.carousel.is-opened  .book.right-off-1 {
  opacity: 0;
  pointer-events: none;
}


.arrow--cover {
  width: 44px;
  height: 44px;
  font-size: 24px;
  line-height: 1;
}


.carousel.is-opening .vertical-arrows,
.carousel.is-opened  .vertical-arrows {
  top: var(--book-offset);       
  left: calc(50% + var(--book-w) + var(--arrow-gap));
  transform: translateY(-50%);   
  height: auto;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 35px;                     
}


.dedication {
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  padding: 6vmin;
}

.dedication-text {
  max-width: 70%;
  text-align: center;
  font-family: Georgia, "Times New Roman", serif;
  font-size: clamp(16px, 2.2vmin, 22px);
  line-height: 1.6;
  opacity: 0.95;
  letter-spacing: 0.2px;
  transform: translateY(-4%);
}

.arrow:disabled {
  opacity: .4;
  cursor: not-allowed;
  filter: grayscale(0.2);
}

.toc {
  width: 100%;
  height: 100%;
  padding: 6vmin 6vmin;
  display: grid;
  grid-template-rows: auto 1fr;
  gap: 2vmin;
  font-family: Georgia, "Times New Roman", serif;
}

.toc-title {
  font-size: clamp(18px, 2.4vmin, 24px);
  letter-spacing: .3px;
  text-align: left;
  opacity: .95;
}

.toc-link:hover .toc-chapter { text-decoration: underline; }
.spread .pane {
  overflow: hidden;            
}

.chapter-page {
  height: 100%;
  display: grid;
  grid-template-rows: auto 1fr;
  gap: 2vmin;
  min-height: 0;  
}

.chapter-body {
  overflow: auto;
  min-height: 0;
}

.toc-list::-webkit-scrollbar,
.chapter-body::-webkit-scrollbar { width: 8px; }
.toc-list::-webkit-scrollbar-thumb,
.chapter-body::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,.25);
  border-radius: 8px;
}
.toc-list::-webkit-scrollbar-track,
.chapter-body::-webkit-scrollbar-track {
  background: transparent;
}


.toc-list .toc-page {
  margin-left: 8px; 
}

.toc-list li {
  list-style: none;
  margin: 0;
  padding: 0;
}

.toc-link {
  display: flex;
  align-items: center;           
  justify-content: space-between; 
  width: 100%;
  background: transparent;
  border: none;
  color: inherit;
  text-align: left;
  cursor: pointer;
  padding: 4px 0;
}

.toc-chapter {
  flex: 0 1 auto; 
  white-space: nowrap; 
  margin-right: 6px;
}

.toc-dots {
  flex: 1 1 auto;
  overflow: hidden;
  text-overflow: clip;
  white-space: nowrap;
  margin: 0 6px;
  opacity: .5;
}

.toc-page {
  flex: 0 0 auto;
  white-space: nowrap;
  margin-left: 6px;
}


.page-blank {
  width: 100%;
  height: 100%;
  background: transparent;     
}


.drag-layer.disabled {
  pointer-events: none; 
  cursor: default;
}


.reader-menu-toggle,
.reader-menu-panel {
  pointer-events: auto;
}

.reader-menu.is-open .reader-menu-toggle .reader-menu-chevron {
  transform: rotate(180deg); 
}
.reader-menu-toggle:hover { transform: translateY(-1px); }
.reader-menu-toggle:active { transform: translateY(0); }
.reader-menu-chevron {
  display: inline-block;
  transform: translateY(-1px);
}

.reader-menu-item:hover {
  transform: translateY(-2px);
  filter: brightness(1.06);
  box-shadow: 0 10px 20px rgba(0,0,0,.45);
}
.reader-menu-item:active { transform: translateY(0); }

@media (max-width: 680px) {
  .reader-menu-panel { width: min(560px, 92vw); }
  .reader-menu-grid {
    grid-auto-flow: row;
    grid-template-columns: repeat(4, 1fr);
    justify-items: center;
    row-gap: 12px;
  }
}


.reader-menu {
  position: absolute;
  left: 50%;
  bottom: -5px;
  transform: translateX(-50%);
  z-index: 1100;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.reader-menu-toggle {
  pointer-events: auto;
  margin-bottom: 8px; 
}

.reader-menu-item {
  position: relative;
  z-index: 1;
}

.reader-menu-grid {
  display: flex;              
  justify-content: center;    
  align-items: center;        
  gap: 8px;                   
  flex-wrap: wrap;            
}

.reader-menu-panel {
  width: min(550px, 70vw); 
  margin: 0 auto;
}


.reader-menu.is-open .reader-menu-panel {
  overflow: visible; 
}

.reader-menu:not(.is-open) .reader-menu-grid {
  transform: translateY(0) !important; 
  top: 0 !important;
}



.reader-menu.is-open .reader-menu-panel {
  transform: translateY(50%);
  transition: transform 700ms cubic-bezier(.25,.8,.25,1); 
}

.reader-menu-grid button:nth-child(1) { background: #f4511e; }
.reader-menu-grid button:nth-child(2) { background: #d81b60; }
.reader-menu-grid button:nth-child(3) { background: #6a1b9a; }
.reader-menu-grid button:nth-child(4) { background: #e53935; }
.reader-menu-grid button:nth-child(5) { background: #7c4dff; }
.reader-menu-grid button:nth-child(6) { background: #e2a9f1; }
.reader-menu-grid button:nth-child(7) { background: #43a047; }





.reader-menu-item.is-active { outline: 2px solid rgba(255,255,255,.18); }

.reader-popover {
  position: absolute;
  bottom: calc(100% + 10px);
  left: 50%;
  transform: translateX(-50%);
  background: #0f0f0f;
  color: #fff;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px;
  padding: 12px 12px 10px;
  box-shadow: 0 12px 30px rgba(0,0,0,.55);
  width: 260px;
  z-index: 2000;
}
.reader-popover::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border-width: 8px;
  border-style: solid;
  border-color: #0f0f0f transparent transparent transparent;
}

.font-size-row {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  margin-bottom: 12px;
}
.font-size-option {
  appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background: #171717;
  color: #fff;
  border-radius: 10px;
  height: 38px;
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: transform 100ms ease, filter 120ms ease, border-color 120ms ease;
}
.font-size-option:hover { transform: translateY(-1px); filter: brightness(1.05); }
.font-size-option.is-active {
  border-color: #7c4dff;
  box-shadow: 0 0 0 2px rgba(124,77,255,.25) inset;
}

.line-height-wrap {
  display: grid;
  grid-template-columns: 1fr auto;
  grid-template-areas:
    "label value"
    "range range";
  align-items: center;
  gap: 8px 10px;
}
.lh-label { grid-area: label; font-size: 12px; opacity: .85; }
.lh-value { grid-area: value; font-size: 12px; opacity: .9; }
.lh-range {
  grid-area: range;
  width: 100%;
  appearance: none;
  height: 6px;
  border-radius: 999px;
  background: rgba(255,255,255,.18);
  outline: none;
}
.lh-range::-webkit-slider-thumb {
  -webkit-appearance: none; appearance: none;
  width: 18px; height: 18px; border-radius: 50%;
  background: #d81b60; border: 2px solid #fff;
  box-shadow: 0 2px 6px rgba(0,0,0,.4);
  cursor: pointer;
}
.lh-range::-moz-range-thumb {
  width: 18px; height: 18px; border-radius: 50%;
  background: #d81b60; border: 2px solid #fff;
  box-shadow: 0 2px 6px rgba(0,0,0,.4);
  cursor: pointer;
}

.reader-fontstyle-popover { width: 280px; }
.font-style-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}
.font-style-option {
  appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background: #171717;
  color: #fff;
  border-radius: 10px;
  height: 48px;
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: transform 100ms ease, filter 120ms ease, border-color 120ms ease;
  font-size: 20px;
}
.font-style-option:hover { transform: translateY(-1px); filter: brightness(1.05); }
.font-style-option.is-active {
  border-color: #6a1b9a;
  box-shadow: 0 0 0 2px rgba(106,27,154,.25) inset;
}

.spread { --reader-font-scale: 1; --reader-line: 1.7; --reader-font-family: Georgia, 'Times New Roman', serif; }

.chapter-body, .toc, .dedication-text { line-height: var(--reader-line) !important; }
.chapter-body      { font-size: calc(16px * var(--reader-font-scale)) !important; }
.dedication-text   { font-size: calc(18px * var(--reader-font-scale)) !important; }
.toc-title,
.chapter-title     { font-size: calc(20px * var(--reader-font-scale)) !important; }
.toc-list,
.toc-link,
.page-blank        { font-size: calc(15px * var(--reader-font-scale)) !important; }

.chapter-body,
.toc,
.dedication-text,
.chapter-title,
.toc-title,
.toc-link {
  font-family: var(--reader-font-family) !important;
}



.spread {
  --reader-page-bg: #2d2d2d;  
  --reader-page-fg: #ffffff;
}

.dedication-text,
.toc,
.toc-title,
.toc-list,
.toc-link,
.toc-page,
.chapter-page,
.chapter-title,
.chapter-body {
  color: var(--reader-page-fg) !important;
}

.reader-menu-item-wrap { position: relative; display: inline-block; }

.reader-dict-popover {
  position: absolute;
  bottom: 100%;                     
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: 12px;              
  z-index: 1100;                    

  width: min(420px, 86vw);
  max-height: 80vh;                 
  overflow: hidden;                 
  display: grid;
  grid-template-rows: auto auto 1fr;
  background: #0f0f0f !important;
  color: #fff !important;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px;
  box-shadow: 0 12px 30px rgba(0,0,0,.55);
}

.dict-title {
  font-size: 18px;
  font-weight: 800;
  margin-bottom: 8px;
  text-align: center;
  color: #fff;
}

.dict-form {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  margin-bottom: 10px;
}

.dict-input {
  width: 100%;
  background: #1b1b1b !important;
  color: #fff !important;
  border: 1px solid rgba(255,255,255,.18) !important;
  border-radius: 10px;
  padding: 10px 12px;
  font: inherit;
  outline: none;
  caret-color: #fff;
}
.dict-input::placeholder { color: rgba(255,255,255,.55); }
.dict-input:focus {
  border-color: #28a9ff !important;
  box-shadow: 0 0 0 2px rgba(40,169,255,.25) inset;
}

.dict-go {
  appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background: #242424;
  color: #fff;
  border-radius: 10px;
  padding: 10px 14px;
  cursor: pointer;
  font-weight: 800;
  transition: transform 100ms ease, filter 120ms ease, border-color 120ms ease;
}
.dict-go:hover:not(:disabled) { transform: translateY(-1px); filter: brightness(1.05); }
.dict-go:disabled { opacity: .5; cursor: not-allowed; }

.dict-results {
  overflow: auto;
  padding-right: 6px;
  display: grid;
  gap: 10px;
  background: #0f0f0f;
  color: #fff;
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,.35) transparent;
}
.dict-results::-webkit-scrollbar { width: 8px; }
.dict-results::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,.35);
  border-radius: 8px;
}
.dict-results::-webkit-scrollbar-track { background: transparent; }

.dict-entry {
  border: 1px solid rgba(255,255,255,.12) !important;
  border-radius: 10px;
  padding: 10px 12px;
  background: #151515 !important;
  color: #fff !important;
}
.dict-head {
  display: flex;
  flex-wrap: wrap;
  gap: 8px 12px;
  align-items: baseline;
  margin-bottom: 6px;
}
.dict-word { font-weight: 900; font-size: 18px; }
.dict-phon { opacity: .8; font-size: 14px; }
.dict-pos  {
  opacity: .8; font-size: 12px;
  border: 1px solid rgba(255,255,255,.2);
  padding: 2px 6px; border-radius: 999px;
}
.dict-senses { margin: 0 0 0 18px; padding: 0; display: grid; gap: 6px; }
.dict-eg  { opacity: .8; font-size: 12px; margin-top: 2px; }

.reader-note-popover {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: 12px;
  z-index: 1100;

  width: min(420px, 86vw);
  max-height: 60vh;
  display: flex;
  flex-direction: column;
  background: #0f0f0f;
  color: #fff;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px;
  padding: 16px;
  gap: 10px;
  overflow: hidden;
  box-shadow: 0 12px 30px rgba(0,0,0,.55);
}

.note-title {
  font-size: 18px;
  font-weight: 800;
  margin: 0;
  text-align: center;
  color: #fff;
}

.note-textarea {
  flex: 1;
  resize: none;
  width: 100%;
  min-height: 200px;
  background: #1b1b1b;
  color: #fff;
  border: 1px solid rgba(255,255,255,.18);
  border-radius: 10px;
  padding: 10px 12px;
  font: inherit;
  line-height: 1.6;
  outline: none;
}
.note-textarea::placeholder { color: rgba(255,255,255,.55); }
.note-textarea:focus {
  border-color: #28a9ff;
  box-shadow: 0 0 0 2px rgba(40,169,255,.25) inset;
}
.note-textarea::-webkit-scrollbar { width: 8px; }
.note-textarea::-webkit-scrollbar-thumb { background: rgba(255,255,255,.35); border-radius: 8px; }
.note-textarea::-webkit-scrollbar-track { background: transparent; }

.reader-tts-popover {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: 12px;
  z-index: 1100;

  width: min(420px, 86vw);
  background: #0f0f0f;
  color: #fff;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 12px;
  padding: 14px 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,.55);
  display: grid;
  gap: 10px;
}

.tts-title {
  font-size: 18px;
  font-weight: 800;
  text-align: center;
  margin: 0 0 6px;
}

.tts-controls {
  display: grid;
  grid-auto-flow: column;
  gap: 8px;
  justify-content: center;
}

.tts-btn {
  appearance: none;
  border: 1px solid rgba(255,255,255,.18);
  background: #242424;
  color: #fff;
  border-radius: 10px;
  padding: 8px 12px;
  font-weight: 800;
  cursor: pointer;
  transition: transform 100ms ease, filter 120ms ease;
}
.tts-btn:hover { transform: translateY(-1px); filter: brightness(1.05); }

.tts-row {
  display: grid;
  grid-template-columns: 80px 1fr auto;
  align-items: center;
  gap: 10px;
}
.tts-label { opacity: .9; font-size: 14px; }
.tts-select, .tts-range {
  width: 100%;
  background: #1b1b1b;
  color: #fff;
  border: 1px solid rgba(255,255,255,.18);
  border-radius: 10px;
  padding: 8px 10px;
  outline: none;
}
.tts-value { opacity: .9; min-width: 52px; text-align: right; font-variant-numeric: tabular-nums; }

.tts-hint { opacity: .7; font-size: 12px; text-align: center; margin-top: 4px; }





















:root{
  --reader-font-base: 1rem;
  --reader-font-scale: 1;             
  --reader-line: 1.7;                  
  --reader-font-family: Georgia, 'Times New Roman', serif; 
  --reader-cushion: 0px;               
}

.spread .pane{ overflow:hidden; }

.chapter-title{
  flex:0 0 auto;
  margin:0 0 calc(1em * var(--reader-line)) 0;   
  font-weight:700;
  font-size:calc(var(--reader-font-base) * var(--reader-font-scale) * 1.15);
  line-height:var(--reader-line);
  font-family:var(--reader-font-family);
  transform:none;
}

.chapter-body{
  flex:1 1 auto;
  min-height:0;
  overflow:hidden;
  box-sizing:content-box;               
  height:auto;
  padding:0;
  padding-bottom:var(--reader-cushion); 
  font-size:calc(var(--reader-font-base) * var(--reader-font-scale));
  line-height:var(--reader-line);
  font-family:var(--reader-font-family);
  white-space:normal;
  word-break:normal;
  overflow-wrap:break-word;
  transform:none;
}

.chapter-body > p{ margin:0; }
.chapter-body > p + p{ margin-top:calc(1em * var(--reader-line)); } 
.chapter-body > *:last-child{ margin-bottom:0; }

.pagination-probe{
  position:absolute;
  left:-99999px; top:-99999px;
  visibility:hidden;
  pointer-events:none;
}

.pagination-probe .chapter-page{
  display:flex;
  flex-direction:column;
  box-sizing:border-box;
  padding:6vmin;                        
  gap:0;
}

.pagination-probe .chapter-title{
  margin:0 0 calc(1em * var(--reader-line)) 0;
  font-weight:700;
  font-size:calc(var(--reader-font-base) * var(--reader-font-scale) * 1.15);
  line-height:var(--reader-line);
  font-family:var(--reader-font-family);
  transform:none;
}

.pagination-probe .chapter-body{
  min-height:0;
  overflow:hidden;
  box-sizing:content-box;
  height:auto;
  padding:0;
  padding-bottom:var(--reader-cushion);
  font-size:calc(var(--reader-font-base) * var(--reader-font-scale));
  line-height:var(--reader-line);
  font-family:var(--reader-font-family);
  white-space:normal;
  word-break:normal;
  overflow-wrap:break-word;
  transform:none;
}

.pagination-probe .chapter-body > p{ margin:0; }
.pagination-probe .chapter-body > p + p{ margin-top:calc(1em * var(--reader-line)); }
.pagination-probe .chapter-body > *:last-child{ margin-bottom:0; }


.spread .chapter-page .chapter-body,
.spread .chapter-page .chapter-body > * {
  width: auto;
  max-width: none;
  margin-inline: 0;
  align-self: stretch;
}

.spread .chapter-page .chapter-body {
  text-align: justify;
  text-align-last: left;
  hyphens: auto;
  -webkit-hyphens: auto;
  -ms-hyphens: auto;
  text-justify: inter-word; 
}

.spread .chapter-page .chapter-body p {
  max-width: none !important;
  margin-inline: 0 !important;
}

.spread .chapter-page {
  padding: 5vmin;
}

.spread { --reader-cushion: calc(1em * var(--reader-line, 1.7)); }

.chapter-title,
.pagination-probe .chapter-title {
  text-align: center !important;
  text-align-last: center !important; 
  text-wrap: balance;                  
}









.spread[style*="--reader-page-bg:#ffffff"] .toc-list,
.spread[style*="--reader-page-bg: #ffffff"] .toc-list,
.spread[style*="--reader-page-bg:#fff"] .toc-list,
.spread[style*="--reader-page-bg: #fff"] .toc-list {
  scrollbar-width: thin;
  scrollbar-color: rgba(0, 0, 0, 0.35) transparent;
}

.spread[style*="--reader-page-bg:#ffffff"] .toc-list::-webkit-scrollbar,
.spread[style*="--reader-page-bg: #ffffff"] .toc-list::-webkit-scrollbar,
.spread[style*="--reader-page-bg:#fff"] .toc-list::-webkit-scrollbar,
.spread[style*="--reader-page-bg: #fff"] .toc-list::-webkit-scrollbar {
  width: 8px; 
}

.spread[style*="--reader-page-bg:#ffffff"] .toc-list::-webkit-scrollbar-track,
.spread[style*="--reader-page-bg: #ffffff"] .toc-list::-webkit-scrollbar-track,
.spread[style*="--reader-page-bg:#fff"] .toc-list::-webkit-scrollbar-track,
.spread[style*="--reader-page-bg: #fff"] .toc-list::-webkit-scrollbar-track {
  background: transparent; 
}

.spread[style*="--reader-page-bg:#ffffff"] .toc-list::-webkit-scrollbar-thumb,
.spread[style*="--reader-page-bg: #ffffff"] .toc-list::-webkit-scrollbar-thumb,
.spread[style*="--reader-page-bg:#fff"] .toc-list::-webkit-scrollbar-thumb,
.spread[style*="--reader-page-bg: #fff"] .toc-list::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.35); 
  border-radius: 8px;               
}


.menu-list .menu-item { display: flex; align-items: center; text-decoration: none; color: inherit; }


.book-back .back-cover {
  width: 100%;
  height: 100%;
  transform: rotateY(180deg);   
  transform-style: preserve-3d;
  backface-visibility: hidden;
}

.book-face .face-fill,
.book-back .back-cover .face-fill {
  width: 100%;
  height: 100%;
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
}

.book-face{
  backface-visibility: hidden !important;
  -webkit-backface-visibility: hidden !important;
  transform-style: preserve-3d !important;
}

.book-back { transform: rotateY(180deg) translateZ(0.01px) !important; }

.book-face .face-layer{
  position: absolute;
  inset: 0;
  background-image: var(--face-url);
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  will-change: transform;
  background-color: #2d2d2d;
}

.book-back .face-layer.out{
  transform: rotateY(180deg) translateZ(0.06px) !important;
}
.book-back .face-layer.in{
  transform: rotateY(0deg) translateZ(0.06px) !important;
}

.book-inner.is-flipped{ transform: rotateY(180deg) !important; }

.book-front .face-layer.out { transform: scaleX(-1) translateZ(0.06px) !important; }
.book-front .face-layer.in  { transform: rotateY(180deg) scaleX(-1) translateZ(0.06px) !important; }
.book-front                  { transform: rotateY(0deg) translateZ(0.01px) !important; }
