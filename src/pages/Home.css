@import "tailwindcss";
@import "tw-animate-css";

:root {
  --book-h: clamp(520px, 70vmin, 660px);
  --book-w: calc(var(--book-h) * 0.7);
  --side-gap: clamp(0px, calc(50vw - var(--book-w)), 100vw);
  --meta-gap: clamp(60px, 2vmin, 40px);
  --arrow-gap: clamp(30px, 5vmin, 32px);
  --meta-w: clamp(200px, 70vmin, 260px);
  --bg: #111;
  --fg: #fff;
  --book-offset: 45%;
}
html, body { height: 100%; }
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  background: var(--bg);
  color: var(--fg);
  font-family: Arial, Helvetica, sans-serif;
}
.app {
  display: flex;
  flex-direction: column;
  height: 100vh;
}
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 28px;
}
.logo { font-size: 28px; font-weight: 800; letter-spacing: .5px; }
.logo span { color: #bfbfbf; }
.header-icons { display: flex; gap: 16px; }
.icon { font-size: 22px; }
.carousel {
  position: relative;
  flex: 1;
  min-height: calc(var(--book-h) + 120px);
  overflow: hidden;
}
.carousel:focus-visible {
  outline: none;
  box-shadow: inset 0 0 0 3px rgba(255,255,255,.9);
  border-radius: 10px;
}
.drag-layer {
  position: absolute;
  inset: 0;
  touch-action: pan-y;
  cursor: grab;
  user-select: none;
  will-change: transform;
  z-index: 2;
  transition: transform 480ms cubic-bezier(.22, .61, .36, 1);
}
.drag-layer.dragging {
  transition: none !important;
  cursor: grabbing;
}
.drag-layer.animating {
  transition: transform 480ms cubic-bezier(.22, .61, .36, 1);
}
.vertical-arrows {
  position: absolute;
  top: 45%;
  left: calc(50% + (var(--book-w) / 2) + var(--arrow-gap));
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  gap: 35px;
  z-index: 4;
}
.arrow {
  appearance: none;
  border: none;
  background: #1f1f1f;
  color: #fff;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: grid;
  place-items: center;
  font-size: 24px;
  line-height: 1;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 2px 6px rgba(0,0,0,.35);
  transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
}
.arrow:hover { transform: translateY(-1px); box-shadow: 0 4px 10px rgba(0,0,0,.4); }
.arrow:active { transform: translateY(0); box-shadow: 0 2px 6px rgba(0,0,0,.35); }
.arrow:focus-visible { outline: 2px solid #fff; outline-offset: 2px; background: #262626; }
.metadata {
  position: absolute;
  top: 45%;
  transform: translateY(-50%);
  width: var(--meta-w);
  left: calc(50% - var(--book-w) - var(--meta-gap));
  z-index: 3;
  display: block;
}
.user-icon { font-size: 28px; margin-bottom: 8px; }
.username { font-weight: bold; margin: 4px 0 12px; }
.icons div { margin: 6px 0; }
.chapters {
  border-top: 1px solid #fff;
  margin-top: 10px;
  padding-top: 10px;
  max-width: 180px;
}
.tags span { display: block; margin: 6px 0; }
.book {
  position: absolute;
  top: var(--book-offset);
  transform: translateY(-50%);
  width: var(--book-w);
  height: var(--book-h);
  display: grid;
  place-items: center;
  border-radius: 6px;
  box-shadow: 0 10px 24px rgba(0,0,0,.45);
  overflow: hidden;
  z-index: 1;
  transition:
    left 500ms cubic-bezier(.25, .8, .25, 1),
    transform 500ms cubic-bezier(.25, .8, .25, 1),
    box-shadow 300ms ease;
}
.book-placeholder {
  width: 100%;
  height: 100%;
  background: #2d2d2d;
  display: grid;
  place-items: center;
  font-size: 14px;
  letter-spacing: 2px;
}
.main-book  { left: 50%; transform: translate(-50%, -50%) scale(1.03); z-index: 2; }
.left-book  { left: calc(50% - (var(--book-w) * 1.5) - var(--side-gap)); }
.right-book { left: calc(50% + (var(--book-w) * 0.5) + var(--side-gap)); }
.left-off-1  { left: calc(50% - (var(--book-w) * 2.5) - (var(--side-gap) * 2)); opacity: .001; pointer-events: none; }
.right-off-1 { left: calc(50% + (var(--book-w) * 1.5) + (var(--side-gap) * 2)); opacity: .001; pointer-events: none; }
.drag-layer.dragging .book.main-book {
  transform: translate(-50%, -50%) scale(1.00);
}
@media (max-width: 1250px) {
  :root {
    --book-w: 380px;
    --book-h: 540px;
    --meta-w: 200px;
  }
}
@media (max-width: 1000px) {
  :root {
    --book-w: 320px;
    --book-h: 460px;
  }
  .metadata { display: none; }
}
.material-symbols-outlined {
  font-family: "Material Symbols Outlined", sans-serif;
  font-weight: normal;
  font-style: normal;
  font-size: 1em;
  line-height: 1;
  display: inline-block;
  letter-spacing: normal;
  text-transform: none;
  white-space: nowrap;
  direction: ltr;
  -webkit-font-smoothing: antialiased;
  font-variation-settings:
    'FILL' var(--ms-fill, 0),
    'wght' var(--ms-wght, 400),
    'GRAD' 0,
    'opsz' var(--ms-opsz, 48);
}
:root{
  --meta-w: clamp(190px, 20vmin, 230px);
  --meta-gap: clamp(90px, 7vmin, 130px);
  --meta-h: clamp(250px, 36vmin, 330px);
  --meta-header-h: 48px;
  --meta-avatar-ring: 42px;
  --meta-avatar-glyph: 24px;
  --meta-name-size: 18px;
  --meta-glyph-size: 56px;
  --meta-count-size: 12px;
  --meta-divider: 1px;
}
.metadata{
  position: absolute;
  top: 45%;
  transform: translateY(-50%);
  left: calc(50% - var(--book-w) - var(--meta-gap));
  width: var(--meta-w);
  height: var(--meta-h);
  color: var(--fg);
  z-index: 3;
  display: block;
}
.meta-header{
  display: grid;
  grid-template-columns: var(--meta-avatar-ring) 1fr;
  column-gap: 10px;
  align-items: center;
  height: var(--meta-header-h);
  margin-bottom: 10px;
  overflow: hidden;
}
.meta-avatar{
  width: var(--meta-avatar-ring);
  height: var(--meta-avatar-ring);
  border-radius: 999px;
  border: 3px solid var(--fg);
  display: grid;
  place-items: center;
}
.meta-avatar svg{
  width: var(--meta-avatar-glyph);
  height: var(--meta-avatar-glyph);
  display: block;
}
.meta-username{
  display: flex;
  align-items: center;
  height: 100%;
  font-weight: 700;
  font-size: var(--meta-name-size);
  line-height: 1.15;
  white-space: normal;
  overflow: hidden;
  max-height: calc(1.15em * 2);
}
.meta-hr{
  border: none;
  border-top: var(--meta-divider) solid rgba(255,255,255,.95);
  margin: 10px 0 12px;
}
.meta-actions{
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  column-gap: 0;
  align-items: start;
  margin-bottom: 2px;
  width: 100%;
}
.meta-actions .meta-icon-btn:nth-child(1){ justify-self: start; }
.meta-actions .meta-icon-btn:nth-child(2){ justify-self: center; }
.meta-actions .meta-icon-btn:nth-child(3){ justify-self: end; }
.meta-icon-btn{
  background: transparent;
  border: none;
  color: var(--fg);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  padding: 0;
}
.meta-icon-glyph{
  font-size: var(--meta-glyph-size);
  --ms-opsz: 48;
  --ms-wght: 250;
  --ms-fill: 0;
  line-height: 1;
}
.meta-icon-btn.is-active .meta-icon-glyph{ --ms-fill: 1; --ms-wght: 400; }
.meta-icon-btn:hover .meta-icon-glyph{ filter: drop-shadow(0 0 .4px rgba(255,255,255,.35)); }
.meta-icon-btn:active .meta-icon-glyph{ transform: translateY(1px) scale(.98); }
.meta-icon-count{
  font-size: var(--meta-count-size);
  line-height: 1;
  opacity: .95;
}
.meta-chapters{
  font-size: 18px;
  font-weight: 800;
  letter-spacing: .2px;
  padding: 2px 0 6px;
}
.meta-tags{
  list-style: none;
  margin: 6px 0 0;
  padding: 0;
  display: block;
}
.meta-tags li{
  font-size: 18px;
  line-height: 1.25;
  margin: 6px 0;
  white-space: normal;
  word-break: break-word;
}
@media (max-width: 1000px){
  .metadata{ display: none; }
}
.meta-icon-btn:hover .meta-icon-glyph {
  transform: scale(1.15);
  transition: transform 120ms ease;
}
.meta-icon-btn:active .meta-icon-glyph { transform: scale(0.95); }
.meta-icon-btn.is-active.like .meta-icon-glyph { --ms-fill: 1; color: #d81b60; }
.meta-icon-btn.is-active.star .meta-icon-glyph { --ms-fill: 1; color: #f2ac15; }
.meta-icon-btn.is-active.save .meta-icon-glyph { --ms-fill: 1; color: #6a1b9a; }
.meta-icon-btn { outline: none; }
.meta-icon-btn:focus { outline: none; box-shadow: none; }
.star-popover {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translate(-50%, -8px);
  background: rgba(20, 20, 20, 0.95);
  border: 1px solid rgba(255,255,255,.2);
  border-radius: 10px;
  padding: 8px 10px;
  box-shadow: 0 8px 22px rgba(0,0,0,.45);
  z-index: 10;
  min-width: 160px;
}
.star-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.star-item {
  appearance: none;
  background: transparent;
  border: none;
  padding: 4px;
  cursor: pointer;
  line-height: 1;
  border-radius: 6px;
  transition: transform 100ms ease;
}
.star-item:hover { transform: scale(1.1); }
.star-hint {
  text-align: center;
  font-size: 12px;
  opacity: .85;
  margin-top: 6px;
}
.meta-icon-btn.is-active.star .meta-icon-glyph { --ms-fill: 1; color: #f2ac15; }
.meta-icon-btn, .star-item {
  outline: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}
.menu-overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  opacity: 0;
  pointer-events: none;
  transition: opacity 200ms ease;
  z-index: 90;
}
.menu-overlay.is-open{
  opacity: 1;
  pointer-events: auto;
}
.side-menu{
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  width: min(360px, 86vw);
  background: #151515;
  color: #fff;
  box-shadow: -10px 0 30px rgba(0,0,0,.55);
  transform: translateX(100%);
  transition: transform 240ms cubic-bezier(.22,.61,.36,1);
  z-index: 100;
  display: flex;
  flex-direction: column;
  border-left: 1px solid rgba(255,255,255,.08);
}
.side-menu.is-open{ transform: translateX(0); }
.menu-header{
  display: grid;
  grid-template-columns: 40px 1fr 40px;
  align-items: center;
  gap: 8px;
  padding: 16px 16px 12px;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.menu-title{ font-size: 26px; font-weight: 800; letter-spacing: .3px; }
.menu-emoji{ font-size: 26px; display: grid; place-items: center; }
.menu-close{
  background: transparent;
  border: none;
  color: #fff;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  justify-self: end;
  -webkit-tap-highlight-color: transparent;
}
.menu-list{
  display: grid;
  gap: 12px;
  padding: 16px;
}
.menu-item{
  display: grid;
  grid-template-columns: 48px 1fr;
  align-items: center;
  gap: 10px;
  padding: 14px 14px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.1);
  background: #1b1b1b;
  color: #fff;
  text-align: left;
  cursor: pointer;
  transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
  -webkit-tap-highlight-color: transparent;
}
.menu-item:hover{
  transform: translateY(-1px);
  box-shadow: 0 8px 18px rgba(0,0,0,.35);
  background: #1f1f1f;
}
.menu-item:active{ transform: translateY(0); }
.menu-text{ font-size: 22px; font-weight: 800; }
.menu-item .menu-emoji{ font-size: 28px; }
.item-profile  { border-left: 10px solid #ff8a00; }
.item-library  { border-left: 10px solid #8b4bff; }
.item-submit   { border-left: 10px solid #ff36a3; }
.item-logout   { border-left: 10px solid #29a3ff; }
.icon-menu{
  background: transparent;
  border: none;
  color: inherit;
  font-size: 22px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}
.icon-menu:focus-visible{
  outline: 2px solid #fff;
  outline-offset: 2px;
  border-radius: 6px;
}
.header {
  position: relative;
  z-index: 200;
}
.menu-overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  opacity: 0;
  pointer-events: none;
  transition: opacity 200ms ease;
  z-index: 190;
}
.menu-overlay.is-open{
  opacity: 1;
  pointer-events: auto;
}
.side-menu{
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  width: min(360px, 86vw);
  background: #151515;
  color: #fff;
  box-shadow: -10px 0 30px rgba(0,0,0,.55);
  transform: translateX(100%);
  transition: transform 240ms cubic-bezier(.22,.61,.36,1);
  z-index: 195;
  display: flex;
  flex-direction: column;
  border-left: 1px solid rgba(255,255,255,.08);
}
.side-menu.is-open{ transform: translateX(0); }
.menu-header{
  display: grid;
  grid-template-columns: 28px 1fr;
  align-items: center;
  gap: 10px;
  padding: 14px 16px 12px;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.menu-title{ font-size: 26px; font-weight: 800; letter-spacing: .3px; }
.menu-burger {
  display: grid;
  gap: 4px;
}
.menu-burger i {
  display: block;
  width: 24px; height: 4px; border-radius: 3px;
  background: #ff6b6b;
}
.menu-burger i:nth-child(2){ background:#7b61ff; }
.menu-burger i:nth-child(3){ background:#28a9ff; }
.menu-list{
  display: grid;
  gap: 0;
}
.menu-item.fill{
  border: none;
  border-radius: 0;
  width: 100%;
  display: grid;
  grid-template-columns: 58px 1fr;
  align-items: center;
  gap: 10px;
  padding: 16px 16px;
  font: inherit;
  color: #fff;
  text-align: left;
  cursor: pointer;
  transition: transform 100ms ease, filter 120ms ease;
  -webkit-tap-highlight-color: transparent;
}
.menu-item.fill:hover{
  transform: translateY(-1px);
  filter: brightness(1.05);
}
.menu-item.fill:active{ transform: translateY(0); }
.menu-text{ font-size: 26px; font-weight: 900; letter-spacing: .2px; }
.menu-item .menu-emoji{ font-size: 34px; display: grid; place-items: center; }
.menu-item.fill.profile { background:#f36b21; }
.menu-item.fill.library { background:#e83e8c; }
.menu-item.fill.submit  { background:#7b1fa2; }
.menu-item.fill.logout  { background:#1e88e5; }
.icon-menu{
  background: transparent;
  border: none;
  color: inherit;
  font-size: 22px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}
.icon-menu:focus-visible{
  outline: 2px solid #fff;
  outline-offset: 2px;
  border-radius: 6px;
}
.header,
.carousel,
.metadata,
.vertical-arrows,
.meta-actions,
.side-menu,
.menu-header,
.menu-list {
  user-select: none;
}
.icon,
.icon-menu,
.arrow,
.menu-close,
.menu-item,
.meta-icon-btn {
  outline: none;
}
.icon:focus,
.icon-menu:focus,
.arrow:focus,
.menu-close:focus,
.menu-item:focus,
.meta-icon-btn:focus {
  outline: none;
  box-shadow: none;
}
.icon-menu:focus-visible,
.arrow:focus-visible,
.menu-close:focus-visible,
.menu-item:focus-visible,
.meta-icon-btn:focus-visible {
  outline: none;
  box-shadow: none;
}
.carousel:focus,
.carousel:focus-visible {
  outline: none;
  box-shadow: none;
}
:root{
  --header-icon-size: 22px;
  --header-btn: 40px;
  --header-gap: 12px;
}
.header-icons{
  display: grid;
  grid-auto-flow: column;
  align-items: center;
  gap: var(--header-gap);
}
.icon-btn{
  display: inline-grid;
  place-items: center;
  width: var(--header-btn);
  height: var(--header-btn);
  font-size: var(--header-icon-size);
  line-height: 1;
  border: none;
  background: transparent;
  color: inherit;
  border-radius: 8px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}
.icon-btn:focus,
.icon-btn:focus-visible{ outline: none; box-shadow: none; }
.icon-menu.duplicate { }
.icon-close{ background: rgba(255,255,255,0.06); }
.menu-header{
  display: grid;
  grid-template-columns: var(--header-btn) 1fr var(--header-btn);
  align-items: center;
  gap: 8px;
  padding: 14px 16px 12px;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.icon-btn.panel-trigger{
  width: var(--header-btn);
  height: var(--header-btn);
  font-size: var(--header-icon-size);
}
.menu-title-wrap{
  display: grid;
  grid-template-rows: auto auto;
  align-items: center;
  justify-items: center;
}
.menu-title{
  font-size: 26px;
  font-weight: 800;
  letter-spacing: .3px;
  line-height: 1.1;
}
.menu-subicons{
  display: grid;
  grid-auto-flow: column;
  gap: 8px;
  margin-top: 4px;
}
.menu-subicons .icon-btn{
  --header-btn: 32px;
  --header-icon-size: 18px;
}
.menu-spacer{ width: var(--header-btn); height: var(--header-btn); }
.menu-list{ display: grid; gap: 0; padding: 0; }
.menu-item.fill{
  border: none; border-radius: 0; width: 100%; min-height: 64px;
  display: grid; grid-template-columns: 64px 1fr; align-items: center;
  gap: 10px; padding: 0 16px; color: #fff; cursor: pointer;
  transition: filter 120ms ease, transform 100ms ease;
  -webkit-tap-highlight-color: transparent;
}
.menu-item.fill:hover{ transform: translateY(-1px); filter: brightness(1.05); }
.menu-item.fill:active{ transform: translateY(0); }
.menu-item.fill .menu-emoji{ display: grid; place-items: center; font-size: 34px; height: 100%; }
.menu-item.fill.profile { background:#f36b21; }
.menu-item.fill.library { background:#e83e8c; }
.menu-item.fill.submit  { background:#7b1fa2; }
.menu-item.fill.logout  { background:#1e88e5; }
.header {
  position: relative;
  z-index: 200;
}
.menu-overlay {
  z-index: 255 !important;
}
.side-menu {
  z-index: 260 !important;
}
.icon-menu {
  position: relative;
  z-index: 270;
}
.header-icons .icon {
  position: relative;
  z-index: 190;
}
.header-icons .icon {
  position: relative;
  z-index: 190;
}
.header-icons .icon.icon-menu {
  position: relative;
  z-index: 270 !important;
  pointer-events: auto;
}
.header {
  position: relative;
  z-index: auto !important;
}
.menu-overlay { z-index: 255 !important; }
.side-menu    { z-index: 260 !important; }
.header-icons .icon.icon-menu {
  position: relative;
  z-index: 1000 !important;
  pointer-events: auto;
}
.header-icons .icon:not(.icon-menu) {
  position: relative;
  z-index: 190 !important;
}
.menu-header {
  display: grid;
  grid-template-columns: var(--header-btn) 1fr var(--header-btn);
  align-items: center;
  min-height: var(--header-btn);
  padding: 0 16px;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.menu-title {
  font-size: 22px;
  font-weight: 800;
  text-align: center;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
}
:root {
  --panel-header-h: 64px;
}
.menu-item.fill {
  min-height: var(--panel-header-h);
}
.menu-header {
  display: grid;
  grid-template-columns: var(--header-btn) 1fr var(--header-btn);
  align-items: center;
  height: var(--panel-header-h);
  padding: 0 16px;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.menu-title {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  line-height: 1;
}
.menu-burger {
  display: grid;
  place-items: center;
  height: 100%;
}
.header-icons .icon.icon-menu[aria-expanded="true"] {
  position: fixed;
  top: 0;
  right: 16px;
  width: var(--panel-header-h);
  height: var(--panel-header-h);
  display: grid;
  place-items: center;
  z-index: 1000 !important;
  background: transparent;
  pointer-events: auto;
}
.header-icons .icon:not(.icon-menu) {
  position: relative;
  z-index: 190 !important;
}
:root {
  --app-header-h: 64px;
}
.header {
  height: var(--app-header-h);
  padding: 0 28px;
  display: flex;
  align-items: center;
}
.menu-header {
  height: var(--app-header-h);
  padding: 0 16px;
  display: grid;
  grid-template-columns: var(--header-btn) 1fr var(--header-btn);
  align-items: center;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.menu-title {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  height: 100%;
}
.header-icons .icon.icon-menu[aria-expanded="true"] {
  position: static !important;
  width: var(--header-btn) !important;
  height: var(--header-btn) !important;
}
:root {
  --app-header-h: 64px;
}
.header {
  height: var(--app-header-h);
  display: flex;
  align-items: center;
  padding: 0 28px;
  position: relative;
  z-index: 900;
}
.header-icons .icon:not(.icon-menu) {
  position: relative;
  z-index: 905;
}
.header-icons .icon.icon-menu {
  position: relative;
  z-index: 1000 !important;
  pointer-events: auto;
}
.menu-overlay { z-index: 950 !important; }
.side-menu    { z-index: 960 !important; }
.menu-header {
  height: var(--app-header-h);
  display: grid;
  grid-template-columns: var(--header-btn) 1fr var(--header-btn);
  align-items: center;
  padding: 0 16px;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}
.menu-title {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  line-height: 1;
  height: 100%;
}
.icon.icon-menu {
  width: var(--header-btn);
  height: var(--header-btn);
  display: grid;
  place-items: center;
  font-size: var(--header-icon-size);
}


/* Sidebar header: match row layout on the left, match app header height overall */
.menu-header {
  /* tall enough to center the top-right menu button */
  height: var(--app-header-h);
  /* but never shorter than the row height */
  min-height: var(--panel-row-h);

  padding: 0 16px;
  display: grid;
  grid-template-columns: 64px 1fr; /* emoji + title (same as rows) */
  align-items: center;
  background: #111;
  border-bottom: 1px solid rgba(255,255,255,.12);
}

/* Emoji column: same size/placement as rows */
.menu-header .menu-emoji {
  display: grid;
  place-items: center;
  font-size: 34px;  /* matches .menu-item .menu-emoji */
  height: 100%;
}

/* Title: same typography as rows, but LEFT-aligned (flex-start) */
.menu-header .menu-title {
  font-size: 26px;   /* matches .menu-text */
  font-weight: 900;
  letter-spacing: .2px;
  display: flex;
  align-items: center;       /* vertical center within the bar */
  justify-content: flex-start; /* LEFT align (not centered) */
  text-align: left;
}


.menu-item.fill { position: relative; }

.menu-item.fill:hover {
  transform: translateY(-1px);  /* keep your lift */
}

/* paint over the exposed 1px with the same background as the row */
.menu-item.fill:hover::after {
  content: "";
  position: absolute;
  left: 0; right: 0;
  bottom: -1px;
  height: 1px;
  background: inherit;          /* matches the row’s color */
  pointer-events: none;
}





/* ───────── BOOK FLIPPING (shadowless clean version) ───────── */

/* The outer card (each book) provides perspective */
.book {
  perspective: 1200px;
  -webkit-perspective: 1200px;
  overflow: visible;       /* avoid edge cuts during flip */
  border-radius: 6px;      /* keep rounded edges */
  box-shadow: none !important; /* remove all shadows */
}

/* The element that rotates */
.book-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  -webkit-transform-style: preserve-3d;
  transform-origin: center center;
  transition: transform 600ms cubic-bezier(.22,.61,.36,1);
  will-change: transform;
  border-radius: inherit;
  box-shadow: none !important; /* remove shadow */
  --flip-cushion: 0px;
  transform: translateY(var(--flip-cushion)) rotateY(0deg);
  cursor: default;
}

/* Faces (front + back) */
.book-face {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: stretch;
  border-radius: inherit;
  overflow: hidden;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  box-shadow: none !important; /* remove shadow */
}

/* FRONT face */
.book-front .book-placeholder {
  background: #2d2d2d; /* or cover image fills this */
}
.book-front .book-placeholder[style*="url("] {
  background-color: transparent;
}

/* BACK face */
.book-back {
  transform: rotateY(180deg);
}
.book-back .book-placeholder.back {
  background: #232323;
  display: grid;
  place-items: center;
  letter-spacing: 2px;
  font-size: 14px;
  opacity: 0.95;
}

/* Flip state */
.book-inner.is-flipped {
  transform: translateY(var(--flip-cushion)) rotateY(180deg);
}

/* Optional cushion while animating */
.book-inner.is-animating {
  --flip-cushion: 10px;
}

/* Ensure clicks land on the flipper */
.drag-layer .book-inner {
  pointer-events: auto;
}

/* While flipping, allow overhang and keep the center card above neighbors */
.carousel.is-flipping {
  position: relative;
  z-index: 1000;
  overflow: visible !important;
}
.carousel.is-flipping .book.main-book {
  overflow: visible;
  position: relative;
  z-index: 1001;
}

/* Center card safe even when idle */
.book.main-book {
  overflow: visible;
  position: relative;
  z-index: 905;
}



/* ───────── Remove unwanted white outlines on books ───────── */
.book-inner,
.book-face,
.book-placeholder {
  outline: none !important;
  box-shadow: none !important;
}

.book-inner:focus,
.book-inner:focus-visible,
.book-face:focus,
.book-face:focus-visible,
.book-placeholder:focus,
.book-placeholder:focus-visible {
  outline: none !important;
  box-shadow: none !important;
}










/* ───────── Flip container tweaks so we can fade it when the spread appears ───────── */
.book { perspective: 1200px; -webkit-perspective: 1200px; overflow: visible; }
.book-inner {
  position: relative; width: 100%; height: 100%;
  transform-style: preserve-3d; -webkit-transform-style: preserve-3d;
  transition: transform 600ms cubic-bezier(.22,.61,.36,1), opacity 280ms ease;
  border-radius: inherit; will-change: transform, opacity;
}
.book-face { position: absolute; inset: 0; backface-visibility: hidden; -webkit-backface-visibility: hidden; }
.book-back { transform: rotateY(180deg); }

/* When 'open', keep the card flipped (back visible) but fade it out so the pages can take over */
.book-inner.is-open { opacity: 0; pointer-events: none; }

/* ───────── OPEN SPREAD (two pages folding in) ───────── */
.open-book {
  position: absolute;
  inset: 0;
  pointer-events: none;            /* becomes clickable only when open */
  opacity: 0;
  transform: translateZ(0);        /* create new stacking context */
  transition: opacity 300ms ease;
  /* inherit the same perspective feel */
  perspective: 1200px; -webkit-perspective: 1200px;
}

/* Enable interaction only when open */
.open-book.is-open { opacity: 1; pointer-events: auto; }

/* Spine in the middle */
.open-spine {
  position: absolute;
  left: 50%;
  top: 0;
  width: 4px;
  height: 100%;
  transform: translateX(-50%);
  background: linear-gradient(90deg, rgba(0,0,0,.35), rgba(255,255,255,.08), rgba(0,0,0,.35));
  box-shadow: 0 0 18px rgba(0,0,0,.35) inset;
  border-radius: 2px;
  z-index: 2;
}

/* Pages */
.open-book .page {
  position: absolute;
  top: 0;
  width: 50%;
  height: 100%;
  background: #e9e7e1;             /* paper color for now */
  overflow: hidden;
  transform-style: preserve-3d;
  transition: transform 650ms cubic-bezier(.22,.61,.36,1), box-shadow 650ms ease;
  will-change: transform, box-shadow;
  /* subtle paper texture suggestion via gradient */
  background-image:
    radial-gradient(100% 100% at 50% 0%, rgba(255,255,255,.65) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(0deg, rgba(0,0,0,.02), rgba(0,0,0,.02));
}

/* Left page hinges on the spine’s right edge; starts folded (hidden) */
.open-book .page.left {
  left: 0;
  border-right: 1px solid rgba(0,0,0,.08);
  transform-origin: right center;
  transform: rotateY(90deg);
  box-shadow: -20px 0 35px rgba(0,0,0,.0);
}

/* Right page hinges on the spine’s left edge; starts folded (hidden) */
.open-book .page.right {
  right: 0;
  border-left: 1px solid rgba(0,0,0,.08);
  transform-origin: left center;
  transform: rotateY(-90deg);
  box-shadow: 20px 0 35px rgba(0,0,0,.0);
}

/* When open: both pages settle flat with soft inner shadows for depth */
.open-book.is-open .page.left {
  transform: rotateY(0deg);
  box-shadow:
    inset -14px 0 18px rgba(0,0,0,.12),
    0 12px 24px rgba(0,0,0,.35);
}
.open-book.is-open .page.right {
  transform: rotateY(0deg);
  box-shadow:
    inset 14px 0 18px rgba(0,0,0,.12),
    0 12px 24px rgba(0,0,0,.35);
}

/* Keep the open spread above neighbors while center is open */
.book.main-book .open-book { z-index: 1002; }
.book.main-book .book-inner { z-index: 1001; }

/* Optional: prevent white outlines from any element */
.open-book, .open-spine, .open-book .page { outline: none !important; box-shadow: none; }



/* 3D stage holder */
.book-stage {
  position: absolute;
  inset: 0;
  perspective: 1200px;
  -webkit-perspective: 1200px;
}

/* Front/back covers: separate siblings (not backfaces) */
.cover {
  position: absolute;
  inset: 0;
  border-radius: 6px;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform-style: preserve-3d;
  transition: opacity 320ms ease, transform 600ms cubic-bezier(.22,.61,.36,1);
  opacity: 0;
  pointer-events: none;
  display: grid;
  place-items: center;
}

/* FRONT default pose */
.cover-front {
  transform: rotateY(0deg);
}

/* BACK default pose (kept rotated out until shown) */
.cover-back {
  transform: rotateY(-180deg);
}

/* Make the requested view visible */
.cover.is-visible {
  opacity: 1;
  pointer-events: auto;
  transform: rotateY(0deg);
}

/* When switching to back, gently rotate the front away for flair */
.book-stage:has(.cover-back.is-visible) .cover-front {
  transform: rotateY(180deg);
  opacity: 0;
  pointer-events: none;
}

/* OPEN spread: two book-sized panes side-by-side, centered */
.spread {
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(var(--book-w) * 2);
  height: var(--book-h);
  transform: translate(-50%, -50%);
  display: grid;
  grid-template-columns: var(--book-w) var(--book-w);
  gap: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 280ms ease;
  z-index: 5; /* above covers when open */
}

/* Appear + enable click when open */
.spread.is-open {
  opacity: 1;
  pointer-events: auto;
}

/* Panes: same size as the book; initially folded; no styling */
.spread .pane {
  width: var(--book-w);
  height: var(--book-h);
  transform-style: preserve-3d;
  transition: transform 650ms cubic-bezier(.22,.61,.36,1);
}

/* Fold-in animation from the center (spine) */
.spread .pane.left  { transform-origin: right center; transform: rotateY(90deg); }
.spread .pane.right { transform-origin: left  center; transform: rotateY(-90deg); }
.spread.is-open .pane.left,
.spread.is-open .pane.right { transform: rotateY(0deg); }



/* --- Covers: default hidden unless .is-visible is present --- */
.cover {
  position: absolute;
  inset: 0;
  border-radius: 6px;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform-style: preserve-3d;
  transition: opacity 320ms ease, transform 600ms cubic-bezier(.22,.61,.36,1);
  opacity: 0;
  pointer-events: none;
  display: grid;
  place-items: center;
}

/* FRONT and BACK base rotations */
.cover-front { transform: rotateY(0deg); }
.cover-back  { transform: rotateY(0deg); } /* keep real back content unrotated; it's a separate element */

/* Visible state */
.cover.is-visible {
  opacity: 1;
  pointer-events: auto;
}

/* Optional minimal fallback text so you can SEE non-image covers */
.cover-fallback {
  padding: 12px 16px;
  font-weight: 700;
  text-align: center;
  /* no color/background set so it uses your existing theme */
}

/* Spread (two panes book-sized, side-by-side, centered) */
.spread {
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(var(--book-w) * 2);
  height: var(--book-h);
  transform: translate(-50%, -50%);
  display: grid;
  grid-template-columns: var(--book-w) var(--book-w);
  gap: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 280ms ease;
  z-index: 5;
}
.spread.is-open { opacity: 1; pointer-events: auto; }

.spread .pane {
  width: var(--book-w);
  height: var(--book-h);
  transform-style: preserve-3d;
  transition: transform 650ms cubic-bezier(.22,.61,.36,1);
  /* no background — you’ll style later */
}
.spread .pane.left  { transform-origin: right center; transform: rotateY(90deg); }
.spread .pane.right { transform-origin: left  center; transform: rotateY(-90deg); }
.spread.is-open .pane.left,
.spread.is-open .pane.right { transform: rotateY(0deg); }



/* Covers — visible background */
.cover-front,
.cover-back {
  background: #2d2d2d; /* same as your book-placeholder */
  color: #fff;
  font-size: 14px;
  display: grid;
  place-items: center;
}

/* Spread panes (open book) */
.spread .pane {
  background: #2d2d2d; /* same neutral fill so you see them */
  color: #fff;
  display: grid;
  place-items: center;
}



/* === 3D FLIPPER (front/back) ================================== */
.book { perspective: 1200px; -webkit-perspective: 1200px; overflow: visible; }

.book-inner {
  position: relative;
  width: 100%; height: 100%;
  transform-style: preserve-3d; -webkit-transform-style: preserve-3d;
  transition: transform 600ms cubic-bezier(.22,.61,.36,1), opacity 280ms ease;
  will-change: transform, opacity;
  border-radius: 6px;
}

/* Faces */
.book-face {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: stretch;
  border-radius: inherit;
  overflow: hidden;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Face content fill (visible fallback color) */
.face-fill {
  width: 100%;
  height: 100%;
  background: #2d2d2d; /* neutral fallback (matches your previous placeholder) */
  color: #fff;
  display: grid;
  place-items: center;
  font-size: 14px;
  letter-spacing: 2px;
}

/* Front/back base rotations */
.book-front { transform: rotateY(0deg); }
.book-back  { transform: rotateY(180deg); }

/* Flip when center is on 'back' or 'open' */
.book-inner.is-flipped { transform: rotateY(180deg); }

/* When 'open', fade the flipper so the spread can take over */
.book-inner.is-open { opacity: 0; pointer-events: none; }

/* Keep the center card safely above neighbors during open */
.carousel.is-flipping { position: relative; z-index: 1000; overflow: visible !important; }
.carousel.is-flipping .book.main-book { overflow: visible; position: relative; z-index: 1001; }
.book.main-book { overflow: visible; position: relative; z-index: 905; }

/* === OPEN SPREAD (two panes) =================================== */
.spread {
  position: absolute;
  top: 50%; left: 50%;
  width: calc(var(--book-w) * 2);
  height: var(--book-h);
  transform: translate(-50%, -50%);
  display: grid;
  grid-template-columns: var(--book-w) var(--book-w);
  gap: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 280ms ease;
  z-index: 1002;
}

.spread.is-open { opacity: 1; pointer-events: auto; }

/* Panes: same size as a book (you can style later) */
.spread .pane {
  width: var(--book-w);
  height: var(--book-h);
  background: #2d2d2d;  /* visible for now; change/remove later */
  color: #fff;
  transform-style: preserve-3d;
  transition: transform 650ms cubic-bezier(.22,.61,.36,1);
  display: grid;
  place-items: center;
}

/* Fold-in animation from the spine */
.spread .pane.left  { transform-origin: right center; transform: rotateY(90deg); }
.spread .pane.right { transform-origin: left  center; transform: rotateY(-90deg); }
.spread.is-open .pane.left,
.spread.is-open .pane.right { transform: rotateY(0deg); }



/* Base: both faces can fade */
.book-face { transition: opacity 220ms ease; }

/* Default visible face */
.book-front { opacity: 1; }
.book-back  { opacity: 0; }

/* When flipped, back is the visible face */
.book-inner.is-flipped .book-front { opacity: 0; }
.book-inner.is-flipped .book-back  { opacity: 1; }

/* During the flip, enforce a brief cross-fade to avoid any mirrored text glimpse */
.book-inner.flip-fading .book-front { opacity: 0; }
.book-inner.flip-fading.is-flipped .book-back { opacity: 1; }



/* === REAL-BOOK OPEN: fold right page, then slide to center ============ */

/* Base spread: two book-sized panes */
.spread {
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(var(--book-w) * 2);
  height: var(--book-h);
  display: grid;
  grid-template-columns: var(--book-w) var(--book-w);
  gap: 0;
  pointer-events: none;
  opacity: 0;
  /* Centered by default */
  transform: translate(-50%, -50%);
  z-index: 1002;
}

/* Panes: visible (neutral) backgrounds so you can see them now */
.spread .pane {
  width: var(--book-w);
  height: var(--book-h);
  background: #2d2d2d;   /* you can style/replace later */
  color: #fff;
  display: grid;
  place-items: center;
  transform-style: preserve-3d;
  transition: transform 360ms cubic-bezier(.22,.61,.36,1);
}

/* Pre-open state (while viewing the BACK cover):
   - Keep the spread invisible
   - Anchor its LEFT page over the current book’s position
   - Fold the RIGHT page inward (hidden) */
.spread.will-open {
  opacity: 0;
  /* Shift so LEFT page sits exactly where the closed book is */
  transform: translate(calc(-50% + (var(--book-w) / 2)), -50%);
}

.spread.will-open .pane.left  { transform: rotateY(0deg); }
.spread.will-open .pane.right { transform: rotateY(-90deg); }

/* When OPEN:
   1) Right page unfolds immediately (rotateY -90 → 0)
   2) After a short delay, the whole spread slides to perfect center
   This creates the “open first, then slide into place” feel. */
.spread.is-open {
  opacity: 1;
  pointer-events: auto;
  /* Slide to center AFTER the fold completes */
  transition:
    opacity 120ms ease 0ms,
    transform 360ms cubic-bezier(.22,.61,.36,1) 280ms; /* 280ms delay */
  transform: translate(-50%, -50%);
}

/* Right page unfolds immediately on open */
.spread.is-open .pane.left  { transform: rotateY(0deg); }
.spread.is-open .pane.right { transform: rotateY(0deg); }


/* === REAL-BOOK OPEN: unfold right page, then slide to center ============ */

/* Spread: two book-sized panes */
.spread {
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(var(--book-w) * 2);
  height: var(--book-h);
  display: grid;
  grid-template-columns: var(--book-w) var(--book-w);
  gap: 0;
  pointer-events: none;
  opacity: 0;
  /* centered by default; animations will override when opening */
  transform: translate(-50%, -50%);
  z-index: 1002;
  perspective: 1200px;
  -webkit-perspective: 1200px;
}

/* Panes: visible for now (same neutral you used before) */
.spread .pane {
  width: var(--book-w);
  height: var(--book-h);
  background: #2d2d2d;   /* change/remove later */
  color: #fff;
  display: grid;
  place-items: center;
  transform-style: preserve-3d;
}

/* Hinge setup */
.spread .pane.left  { transform-origin: right center; }
.spread .pane.right { transform-origin: left  center; }

/* Pre-open anchor:
   While the back cover is visible (or just before opening),
   keep the spread invisible and positioned so the LEFT page
   sits exactly where the closed book is. The RIGHT page is folded in. */
.spread.will-open {
  opacity: 0;
  transform: translate(calc(-50% + (var(--book-w) / 2)), -50%);
}
.spread.will-open .pane.left  { transform: rotateY(0deg); }
.spread.will-open .pane.right { transform: rotateY(-180deg); }

/* On OPEN:
   1) Right page unfolds (−180° → 0°)
   2) Then, the whole spread slides into perfect center */
.spread.is-open {
  opacity: 1;
  pointer-events: auto;
  /* Slide AFTER the unfold finishes (delay matches the page animation) */
  animation: slideSpreadCenter 380ms cubic-bezier(.22,.61,.36,1) 420ms forwards;
}

/* Unfold the right page immediately */
.spread.is-open .pane.right {
  animation: rightPageUnfold 420ms cubic-bezier(.22,.61,.36,1) forwards;
}
.spread.is-open .pane.left { transform: rotateY(0deg); } /* stays flat */

/* Keyframes */
@keyframes rightPageUnfold {
  from { transform: rotateY(-180deg); }
  to   { transform: rotateY(0deg); }
}
@keyframes slideSpreadCenter {
  from { transform: translate(calc(-50% + (var(--book-w) / 2)), -50%); }
  to   { transform: translate(-50%, -50%); }
}
