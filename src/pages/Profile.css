/* ===== App frame ===== */
.profile-app {
  height: 100svh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
.profile-app .header { flex: 0 0 auto; }
.profile-page {
  flex: 1 1 auto;
  min-height: 0;
  overflow: hidden;
  padding: clamp(12px, 2vw, 24px);
  box-sizing: border-box;
}

/* Only the profile page gets a black header */
.header { background: transparent; }
.profile-app > .header { background-color: #000; }

/* ===== Global grid (3 columns × 3 rows) ===== */
.profile-grid {
  height: 100%;
  display: grid;
  grid-template-columns: minmax(0, 1fr) fit-content(clamp(260px, 36vw, 360px)) minmax(0, 1fr);
  grid-template-rows: auto 1fr auto !important; /* final layout */
  gap: clamp(16px, 2vw, 28px);
}

/* Place cells */
.identity-cell  { grid-column: 1; grid-row: 1; align-self: start; }
.stories-cell   { grid-column: 1; grid-row: 2; align-self: stretch; }
.favorites-cell { grid-column: 1; grid-row: 3; align-self: end; }

.feature-cell   { grid-column: 2; grid-row: 1 / 4; align-self: stretch; }

.library-cell   { grid-column: 3; grid-row: 1 / 3; align-self: stretch; }
.current-cell   { grid-column: 3; grid-row: 3; align-self: end; }

/* Generic cell wrapper */
.cell { min-width: 0; min-height: 0; overflow: hidden; }

/* ===== Titles ===== */
.section { container-type: inline-size; display: flex; flex-direction: column; min-height: 0; }
.section-title { margin: 0 0 10px; font-size: clamp(0.9rem, 5cqw, 1.6rem); line-height: 1.1; font-weight: 600; }

/* ===== Identity block ===== */
.profile-card { display: flex; align-items: center; gap: 18px; min-width: 0; }
.profile-avatar { width: 96px; height: 96px; display: inline-flex; align-items: center; justify-content: center; }
.profile-avatar svg { width: 96px; height: 96px; }

.profile-id {
  display: grid;
  grid-auto-rows: max-content;
  flex: 1 1 auto;
  min-width: 0;
  container-type: inline-size;
  justify-items: start;
  text-align: left;
  color: #fff;
}
.profile-id .profile-name {
  margin: 0 0 2px;
  font-weight: 800;
  font-size: clamp(1rem, 8cqw, 2.4rem);
  line-height: 1.24;
  padding-bottom: 0.18em;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.profile-id .profile-handle {
  margin: 0 0 8px;
  opacity: 0.8;
  font-weight: 600;
  line-height: 1.1;
  font-size: clamp(0.9rem, 5cqw, 1.6rem);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.profile-id .profile-handle { margin-top: -0.22em; } /* visual compensation */

/* Left-aligned 75% color bars */
.profile-bars {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  height: 8px;
  gap: 0;
  width: 75%;
  margin: 0;
  justify-self: start;
  align-self: start;
}
.profile-bars .bar { width: 100%; height: 100%; }
.bar-1 { background: #de5a43; }
.bar-2 { background: #d006c1; }
.bar-3 { background: #6c2ea8; }
.bar-4 { background: #1e90ff; }

/* ===== Black strips ===== */
.strip { background: #000; border: none; }
.section .strip { flex: 0 0 auto !important; } /* strips size to content */

/* ===== Center feature card ===== */
.feature-card {
  background: #000; border: none; width: auto; justify-self: center; height: 100%;
  display: flex; align-items: center; justify-content: center;
  padding: clamp(12px, 1.6vw, 16px); box-sizing: border-box; text-align: center; overflow: visible;
}
.feature-stack { display: flex; flex-direction: column; align-items: center; gap: clamp(10px, 2vh, 14px); min-width: 0; max-height: 100%; }

:root { --fit-w: min(clamp(130px, 24vh, 260px), 42vw); }
.feature-card .feature-stack { width: var(--fit-w); max-width: 100%; padding-left: calc(var(--fit-w) * 0.25); padding-right: calc(var(--fit-w) * 0.25); box-sizing: content-box; margin: 0 auto; }
.feature-cover-placeholder { width: var(--fit-w); aspect-ratio: 12 / 17; background: #1b1b1b; border: none; }

.feature-info { width: 100%; max-width: var(--fit-w); margin: 0 auto; text-align: center; overflow: hidden; container-type: inline-size; }
.feature-title { margin: 0 0 10px; font-weight: 900; line-height: 1.1; font-size: clamp(1.25rem, 6.2cqw, 2.2rem); }

.meta-hr { border: 0; height: 1px; background: rgba(255,255,255,0.12); margin: clamp(6px, 1vh, 8px) 0; }

.feature-author { display: flex; align-items: center; justify-content: center; gap: 8px; min-height: 28px; }
.meta-avatar--sm { width: 26px; height: 26px; display: inline-flex; align-items: center; justify-content: center; }
.meta-avatar--sm svg { width: 26px; height: 26px; }
.feature-author-name { font-weight: 600; font-size: clamp(0.95rem, 4.2cqw, 1.25rem); }

.feature-info .meta-chapters { font-size: clamp(0.95rem, 4.2cqw, 1.25rem); line-height: 1.2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin: 0; }
.align-left { text-align: left; margin: 0 auto; max-width: var(--fit-w); font-size: clamp(0.78rem, 1.35vh, 0.95rem); line-height: 1.25; }

.feature-info,
.feature-title,
.feature-author-name,
.align-left,
.align-left * { overflow-wrap: anywhere; word-break: break-word; hyphens: auto; }

/* Actions */
.meta-actions {
  width: 100%; max-width: var(--fit-w);
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0;
  align-items: center; justify-content: normal;
  padding-block: 6px; margin: 0; container-type: inline-size; overflow: visible;
}
.meta-actions .meta-icon-btn {
  display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px;
  width: 100%; min-width: 0; padding: 0; margin: 0; border: 0; background: transparent; box-shadow: none;
}
.meta-actions .meta-icon-glyph { font-size: clamp(52px, 12cqw, 96px); line-height: 1; }
.meta-actions .meta-icon-btn svg { height: clamp(48px, 11cqw, 92px); width: auto; }
.meta-actions .meta-icon-count { white-space: nowrap; text-align: center; line-height: 1.1; font-size: clamp(0.78rem, 3.2cqw, 1rem); font-variant-numeric: tabular-nums; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
.meta-actions .meta-icon-btn.star { position: relative; }
.meta-actions .meta-icon-btn.star .star-popover {
  position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%);
  z-index: 5; background: #111; border: 1px solid rgba(255,255,255,0.12); border-radius: 10px;
  padding: 8px 10px; box-shadow: 0 8px 22px rgba(0,0,0,0.35); min-width: 180px;
}
.meta-actions .meta-icon-btn.star .star-popover * { pointer-events: auto; }

/* ===== Genres ===== */
.feature-info .meta-tags { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 8px 10px; padding: 0; margin: 0; list-style: none; text-align: center; }
.feature-info .meta-tags li {
  display: inline-flex; align-items: center; padding: 6px 12px; border-radius: 999px; line-height: 1;
  white-space: nowrap; font-weight: 600; font-size: clamp(0.85rem, 3.2cqw, 1.05rem);
  transition: transform 120ms ease, box-shadow 120ms ease, filter 120ms ease;
}
.feature-info .meta-tags li:active { transform: translateY(1px); }
.feature-info .meta-tags.meta-tags--outline li { color: #fff; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.22); box-shadow: inset 0 0 0 0 rgba(255,255,255,0); }
.feature-info .meta-tags.meta-tags--outline li:hover { border-color: rgba(255,255,255,0.36); background: rgba(255,255,255,0.10); }
.feature-info .meta-tags li::before,
.feature-info .meta-tags li::after { content: none !important; }

/* ===== Library (fills remainder on the right) ===== */
.right-title { display: flex; align-items: baseline; gap: 6px; }
.library-cell { display: flex; flex-direction: column; min-height: 0; }
.shelf {
  background: #4b2419; padding: 20px; border: 1px solid rgba(0,0,0,0.2); border-radius: 0;
  flex: 1 1 auto; display: flex; flex-direction: column; gap: 20px; min-height: 0;
}
.shelf-row { background: #111; flex: 1; border-radius: 0; }

/* ===== Favorites & Currently Reading (bottom-aligned) ===== */
.favorites-cell.section,
.current-cell.section { display: flex; flex-direction: column; min-height: 0; }

.favorites-strip,
.current-strip {
  display: block !important;
  padding: clamp(10px, 1.6vw, 16px) !important;
  box-sizing: border-box;
  background: #000;
}
.favorites-strip .favorites-grid,
.current-strip  .current-grid {
  display: grid !important;
  grid-template-columns: repeat(5, minmax(0, 1fr)) !important;
  gap: clamp(8px, 1.6vw, 16px) !important;
  justify-items: center !important;
  align-items: center !important;
  margin: 0 !important;
  padding: 0 !important;
}
.fav-cover,
.cur-cover {
  width: 100% !important; max-width: none !important; aspect-ratio: 12 / 17 !important; height: auto !important;
  background: #1b1b1b; border: none;
}

/* ===== Stories (smooth scroll + custom pill; pill only when scrollable) ===== */
.stories-cell.section { display: flex; flex-direction: column; min-height: 0; }
.stories-cell .section-title { margin-bottom: 8px; }
.stories-strip {
  display: grid !important;
  grid-template-rows: max-content max-content;
  align-content: center;
  justify-items: stretch;
  gap: 8px;
  padding: clamp(8px, 1.2vw, 12px);
  background: #000;
  box-sizing: border-box;
  min-height: 0;
}
.stories-viewport {
  overflow-x: auto !important; overflow-y: hidden !important;
  scroll-behavior: auto !important; scroll-snap-type: none !important;
  scrollbar-width: none; min-height: 0;
}
.stories-viewport::-webkit-scrollbar { display: none; }
.stories-track { display: flex !important; gap: clamp(8px, 1.6vw, 16px) !important; align-items: center !important; }
.story-cover {
  flex: 0 0 calc((100% - (4 * clamp(8px, 1.6vw, 16px))) / 5) !important;
  aspect-ratio: 12 / 17 !important; height: auto !important; background: #1b1b1b; border: none;
}
.stories-progress {
  position: static !important; width: 100%; height: 8px; border-radius: 9999px;
  background: transparent !important; margin: 2px 0 0 0; touch-action: none; cursor: pointer;
}
.stories-thumb {
  position: relative; display: block; height: 100%; border-radius: 9999px;
  background: #fff; box-shadow: 0 0 0 2px #000;
}

/* ===== Responsive tweaks ===== */
@media (max-width: 900px) {
  .profile-grid {
    grid-template-columns: minmax(0, 1fr) fit-content(clamp(220px, 42vw, 320px)) minmax(0, 1fr);
    gap: 12px;
  }
}
@media (max-width: 560px), (max-height: 680px) {
  .meta-actions .meta-icon-glyph { font-size: clamp(26px, 8cqw, 38px); }
  .meta-actions .meta-icon-count { font-size: clamp(0.7rem, 3cqw, 0.9rem); }
}

/* Large-screen spacing tuning */
@media (min-width: 1200px) and (min-height: 850px) {
  .identity-cell { align-self: stretch; }
  .profile-identity { display: flex; flex-direction: column; justify-content: center; padding-block: clamp(8px, 3vh, 36px); }
  .profile-avatar, .profile-avatar svg { width: clamp(96px, 12vh, 148px); height: clamp(96px, 12vh, 148px); }
  .profile-id { row-gap: clamp(4px, 1.4vh, 18px); }
  .profile-id .profile-name { line-height: 1.2; }
  .profile-id .profile-handle { line-height: 1.25; }
  .stories-cell { align-self: stretch; }
  .stories-strip { align-content: end !important; }
  .favorites-strip, .current-strip { padding-block: clamp(8px, 1.4vh, 16px) !important; }
}
@media (min-width: 1024px) and (min-height: 760px) {
  .stories-strip { align-content: end !important; }
}

/* ===== Accessibility / focus tweaks ===== */
*:focus { outline: none !important; caret-color: transparent !important; }
button:focus,
input[type="range"]:focus,
[tabindex]:focus,
a:focus,
.story-cover:focus,
.fav-cover:focus,
.cur-cover:focus { outline: none !important; box-shadow: none !important; }

.story-cover,
.fav-cover,
.cur-cover,
.feature-card,
.section,
.header,
.profile-grid { user-select: none; }

.stories-viewport,
.favorites-strip,
.current-strip { caret-color: transparent !important; }

:focus-visible { outline: 2px solid rgba(255, 255, 255, 0.4); outline-offset: 2px; }


/* ===== Genre tag coloring (rotating soft hues) ===== */
.feature-info .meta-tags.meta-tags--outline li {
  color: #fff;
  border: 1px solid rgba(255,255,255,0.22);
  background: hsla(var(--chip-h, 0), 75%, 60%, 0.14);
  border-color: hsla(var(--chip-h, 0), 75%, 60%, 0.35);
  transition: background 120ms ease, border-color 120ms ease;
}

/* pleasant rotating hues (very soft tint) */
.feature-info .meta-tags.meta-tags--outline li:nth-child(6n+1){ --chip-h: 210; } /* blue */
.feature-info .meta-tags.meta-tags--outline li:nth-child(6n+2){ --chip-h: 12;  } /* orange */
.feature-info .meta-tags.meta-tags--outline li:nth-child(6n+3){ --chip-h: 280; } /* purple */
.feature-info .meta-tags.meta-tags--outline li:nth-child(6n+4){ --chip-h: 140; } /* green */
.feature-info .meta-tags.meta-tags--outline li:nth-child(6n+5){ --chip-h: 320; } /* magenta */
.feature-info .meta-tags.meta-tags--outline li:nth-child(6n+6){ --chip-h: 40;  } /* amber */

.feature-info .meta-tags.meta-tags--outline li:hover {
  background: hsla(var(--chip-h, 0), 75%, 60%, 0.22) !important;
  border-color: hsla(var(--chip-h, 0), 75%, 60%, 0.46) !important;
  filter: none !important;
  -webkit-filter: none !important;
}

.profile-bars .bar-1 { background: #fc5f2e; } /* orange */
.profile-bars .bar-2 { background: #d81b60; } /* pink */
.profile-bars .bar-3 { background: #6a1b9a; } /* purple */
.profile-bars .bar-4 { background: #1e88e5; } /* blue */








/* Fill each shelf row with individual, responsive spines */
.shelf {
  background: #4b2419;
  padding: clamp(14px, 1.6vw, 20px);
  border: 1px solid rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;
  gap: clamp(14px, 1.6vw, 20px);
  min-height: 0;
}

.shelf-row {
  background: #111;
  flex: 1 1 0;
  display: flex;                                 /* equal-width spines */
  gap: clamp(8px, 1vw, 14px);
  padding: clamp(10px, 1.2vw, 16px);
  min-height: 0;
}

.book-spine {
  flex: 1 1 0;                                   /* stretch to fill row */
  height: 100%;
  border-radius: 2px;
  background: #1e88e5;                           /* default */
}

/* Color cycle to mimic a varied bookshelf */
.shelf-row .book-spine:nth-child(12n+1)  { background: #fc5f2e; } /* orange */
.shelf-row .book-spine:nth-child(12n+2)  { background: #d81b60; } /* pink */
.shelf-row .book-spine:nth-child(12n+3)  { background: #6a1b9a; } /* purple */
.shelf-row .book-spine:nth-child(12n+4)  { background: #1e88e5; } /* blue */
.shelf-row .book-spine:nth-child(12n+5)  { background: #00bcd4; } /* teal */
.shelf-row .book-spine:nth-child(12n+6)  { background: #43a047; } /* green */
.shelf-row .book-spine:nth-child(12n+7)  { background: #ffd54f; } /* yellow */
.shelf-row .book-spine:nth-child(12n+8)  { background: #ff9800; } /* amber */
.shelf-row .book-spine:nth-child(12n+9)  { background: #7b1fa2; } /* deep purple */
.shelf-row .book-spine:nth-child(12n+10) { background: #ec407a; } /* pink 300 */
.shelf-row .book-spine:nth-child(12n+11) { background: #ef5350; } /* red 400 */
.shelf-row .book-spine:nth-child(12n+12) { background: #26c6da; } /* cyan 300 */

/* Invert colors for the middle shelf (row 2) */
/* Row 2: full reversed palette (purple ➜ orange) */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+1)  { background: #6a1b9a !important; } /* purple */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+2)  { background: #d81b60 !important; } /* pink */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+3)  { background: #7b1fa2 !important; } /* deep purple */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+4)  { background: #26c6da !important; } /* cyan */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+5)  { background: #1e88e5 !important; } /* blue */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+6)  { background: #00bcd4 !important; } /* teal */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+7)  { background: #43a047 !important; } /* green */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+8)  { background: #ffd54f !important; } /* yellow */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+9)  { background: #ff9800 !important; } /* amber */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+10) { background: #ef5350 !important; } /* red */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+11) { background: #ec407a !important; } /* pink 300 */
.shelf .shelf-row:nth-child(2) .book-spine:nth-child(12n+12) { background: #fc5f2e !important; } /* orange */



.shelf-row {
  padding-bottom: 0 !important;
}


/* 1) Remove only TOP/BOTTOM margin on the profile section */
.profile-page {
  margin-block: 0 !important;  /* margin-top & margin-bottom = 0 */
}

/* If your identity section has its own margins, zero just its vertical ones too */
.identity-cell {
  margin-block: 0 !important;
}

/* 2) Tighten the username + name stack */
.profile-id {
  display: grid;
  grid-auto-rows: max-content;
  row-gap: 2px; /* bring them closer */
}

/* Override any inline margins on these elements */
.profile-id .profile-handle {
  margin: 0 0 2px 0 !important;  /* smaller gap above name */
  line-height: 1.05;
}

.profile-id .profile-name {
  margin: 0 !important;          /* no extra space below */
  line-height: 1.05;
}

/* Remove only top & bottom padding from profile-identity */
.profile-identity {
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

/* Add more breathing room above the colored bars */
.profile-bars {
  margin-top: 10px !important;   /* increase this value to control spacing */
}

.profile-id {
  row-gap: 2px; /* keep handle & name tight */
}

.profile-bars {
  margin-top: 10px !important; /* creates clear separation below name */
}

/* Make the profile picture expand fully top-to-bottom */
.profile-card {
  align-items: stretch !important; /* make both avatar & info same height */
}

.profile-avatar {
  height: 100% !important;          /* fill full vertical height of identity area */
  aspect-ratio: 1 / 1 !important;   /* keep it square */
  display: flex;
  align-items: center;
  justify-content: center;
}

.profile-avatar svg {
  height: 100% !important;          /* make SVG fill the avatar box */
  width: auto !important;
}

/* Make the avatar visibly bigger (square) */
.profile-avatar,
.profile-avatar svg {
  width: clamp(160px, 20vh, 320px) !important;
  height: clamp(160px, 20vh, 320px) !important;
}

/* 1) Slightly smaller avatar (still square) */
.profile-avatar,
.profile-avatar svg {
  width: clamp(150px, 18vh, 300px) !important;
  height: clamp(150px, 18vh, 300px) !important;
}

/* 2) Center the right stack to the middle of the avatar */
.profile-card {
  align-items: center !important; /* centers both columns in the row */
}

.profile-id {
  display: flex !important;
  flex-direction: column;
  justify-content: center;        /* centers name+username+bars vertically */
  gap: 4px;                       /* keep them nicely tight */
}

/* keep your existing spacing between name and the colored bar */
.profile-bars { margin-top: 10px; }

/* --- PRIORITIZE Stories & Favorites on small screens --- */
@media (max-width: 900px), (max-height: 760px) {
  /* 1) Make the avatar a bit smaller so the identity block shrinks first */
  .profile-avatar,
  .profile-avatar svg {
    width: clamp(120px, 15vh, 220px) !important;
    height: clamp(120px, 15vh, 220px) !important;
  }

  /* 2) Allow the identity block to cap its height and not push Stories/Favorites down */
  .identity-cell { min-height: 0 !important; overflow: hidden !important; }
  .profile-identity { max-height: 100% !important; }
  .profile-card { height: auto !important; }
  .profile-id { row-gap: 2px; }

  /* 3) Ensure Stories/Favorites get the space (row 2 is already 1fr in your grid) */
  .stories-cell { min-height: 0 !important; }
  .stories-viewport { min-height: 0 !important; }
}

/* If you want the effect even earlier (very tight devices), add a stricter breakpoint */
@media (max-width: 560px), (max-height: 680px) {
  .profile-avatar,
  .profile-avatar svg {
    width: clamp(108px, 14vh, 200px) !important;
    height: clamp(108px, 14vh, 200px) !important;
  }
}


/* Give the shelf a subtle 3D context so lifts feel natural */
.shelf-row {
  perspective: 800px;
}

/* Base state */
.book-spine {
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
  transform: translateY(0) translateZ(0);
  will-change: transform;
}

/* Hover / focus lift */
.book-spine:hover,
.book-spine:focus-visible {
  transform: translateY(-6px) translateZ(0) scale(1.02);
  box-shadow:
    0 6px 14px rgba(0,0,0,0.28),
    0 2px 4px rgba(0,0,0,0.18);
  filter: brightness(1.02);
}

/* Pressed/tap feedback */
.book-spine:active {
  transform: translateY(-2px) scale(1.01);
  box-shadow:
    0 3px 8px rgba(0,0,0,0.24),
    0 1px 2px rgba(0,0,0,0.16);
}

/* Keyboard accessibility: show a visible ring without shifting layout */
.book-spine:focus-visible {
  outline: none;
  box-shadow:
    0 6px 14px rgba(0,0,0,0.28),
    0 2px 4px rgba(0,0,0,0.18),
    0 0 0 2px rgba(255,255,255,0.6) inset;
}

/* Respect users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  .book-spine {
    transition: none;
  }
}


/* Heatmap should fill width and size its own height */
.reading-heatmap svg { width: 100%; height: auto; display: block; }

/* If the package shows legend/labels, hide to avoid overlap (optional) */
.reading-heatmap .w-heatmap-legend,
.reading-heatmap .w-heatmap-week,
.reading-heatmap .w-heatmap-month { display: none !important; }

/* Make the heatmap container a normal block (not the old 5-col grid) */
.current-strip .current-grid {
  display: block !important;
  grid-template-columns: none !important;
}

/* Let the heatmap fill width and size its own height */
.reading-heatmap svg {
  width: 100%;
  height: auto;
  display: block;
}

/* Make the heatmap container a normal block (not the old 5-col grid) */
.current-strip .current-grid {
  display: block !important;
  width: 100% !important;
  grid-template-columns: none !important;
}

/* Let the heatmap fill the entire width of its container */
.reading-heatmap { width: 100%; }
.reading-heatmap svg { width: 100%; height: auto; display: block; }

/* Make BOTH bottom cells use the full grid row height */
.favorites-cell,
.current-cell {
  align-self: stretch !important;
}

/* Let the black boxes fill those cells */
.favorites-strip,
.current-strip {
  height: 100% !important;
  display: block !important;
  box-sizing: border-box;
}

/* Keep the heatmap container from collapsing while still sizing naturally */
.current-strip .current-grid {
  height: 100% !important;
  display: block !important; /* overrides the old 5-col grid */
}

/* 1) UNHIDE anything we previously hid */
.reading-heatmap .w-heatmap-week,
.reading-heatmap .w-heatmap-month,
.reading-heatmap .w-heatmap-legend {
  display: block !important;
}

/* 2) Make month + weekday labels white and fully opaque */
.reading-heatmap .w-heatmap-week text,
.reading-heatmap .w-heatmap-month text {
  fill: #fff !important;
  opacity: 1 !important;
  font-weight: 600;
}

/* 3) Even, larger spacing for the BUILT-IN legend */
.reading-heatmap .w-heatmap-legend {
  display: flex !important;         /* normalize layout to flex */
  align-items: center;
  gap: 10px;                        /* <-- increase/decrease to taste */
  margin-top: 8px;
}
.reading-heatmap .w-heatmap-legend > * {
  margin: 0 !important;             /* reset any lib inline margins */
}
.reading-heatmap .w-heatmap-legend .w-heatmap-legend-item {
  margin-right: 10px !important;    /* fallback for older versions */
}
.reading-heatmap .w-heatmap-legend .w-heatmap-legend-title {
  color: rgba(255,255,255,0.9);
  font-size: 12px;
  font-weight: 600;
}

/* Make month & weekday labels BRIGHT white (override any fades) */
.reading-heatmap .w-heatmap-week,
.reading-heatmap .w-heatmap-month {
  opacity: 1 !important;           /* if the group is faded */
  filter: none !important;
}

.reading-heatmap .w-heatmap-week text,
.reading-heatmap .w-heatmap-month text {
  fill: #fff !important;           /* SVG text color */
  fill-opacity: 1 !important;      /* some builds use this */
  opacity: 1 !important;           /* override inline opacity */
  color: #fff !important;          /* just in case */
  font-weight: 700;                /* slightly bolder for legibility */
  text-shadow: none;               /* ensure no blend tricks */
  stroke: none !important;
}

.reading-heatmap { opacity: 1 !important; }

/* Make month & weekday labels bright white (the lib uses currentColor) */
.reading-heatmap svg.w-heatmap {
  color: #fff !important;          /* <- this drives the text fill */
}

/* Optional: a touch crisper/bolder */
.reading-heatmap svg.w-heatmap text {
  font-weight: 700;
  text-rendering: geometricPrecision;
}

/* Make the built-in legend spacing match your grid rhythm */
.reading-heatmap .w-heatmap-legend {
  display: flex !important;
  align-items: center;
  gap: 10px;                        /* tweak to taste */
  margin-top: 8px;
}
.reading-heatmap .w-heatmap-legend > * {
  margin: 0 !important;             /* reset inline margins */
}

/* Hover tooltip for built-in legend swatches */
.reading-heatmap .w-heatmap-legend [data-tip]::after {
  content: attr(data-tip);
  position: absolute;
  left: 50%;
  bottom: calc(100% + 8px);
  transform: translateX(-50%);
  background: rgba(0,0,0,0.92);
  color: #fff;
  font-size: 12px;
  font-weight: 600;
  line-height: 1;
  padding: 6px 8px;
  border-radius: 8px;
  white-space: nowrap;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
  opacity: 0;
  pointer-events: none;
  transition: opacity 120ms ease, transform 120ms ease;
  z-index: 5;
}

.reading-heatmap .w-heatmap-legend [data-tip]::before {
  content: "";
  position: absolute;
  left: 50%;
  bottom: calc(100% + 4px);
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-top-color: rgba(0,0,0,0.92);
  opacity: 0;
  transition: opacity 120ms ease;
  z-index: 5;
}

.reading-heatmap .w-heatmap-legend [data-tip]:hover::after,
.reading-heatmap .w-heatmap-legend [data-tip]:hover::before {
  opacity: 1;
}

/* Tooltip bubble for legend swatches */
.reading-heatmap .w-heatmap-legend [data-tip]::after {
  content: attr(data-tip);
  position: absolute;
  left: 50%;
  bottom: calc(100% + 8px);
  transform: translateX(-50%);
  background: rgba(0,0,0,0.92);
  color: #fff;
  font-size: 12px;
  font-weight: 600;
  line-height: 1;
  padding: 6px 8px;
  border-radius: 8px;
  white-space: nowrap;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
  opacity: 0;
  pointer-events: none;
  transition: opacity 120ms ease, transform 120ms ease;
  z-index: 5;
}

.reading-heatmap .w-heatmap-legend [data-tip]::before {
  content: "";
  position: absolute;
  left: 50%;
  bottom: calc(100% + 4px);
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-top-color: rgba(0,0,0,0.92);
  opacity: 0;
  transition: opacity 120ms ease;
  z-index: 5;
}

.reading-heatmap .w-heatmap-legend [data-tip]:hover::after,
.reading-heatmap .w-heatmap-legend [data-tip]:hover::before {
  opacity: 1;
}

/* Center the whole stories block (title + strip) within its row */
.stories-cell.section {
  justify-content: center !important;  /* flex container centers children vertically */
}

/* Keep the strip’s internal layout centered too */
.stories-strip {
  align-content: center !important;    /* overrides earlier 'end' rules on large screens */
}

/* Optional: if you want the section to shrink to its content (not stretch),
   uncomment the next line to center the whole section within the grid row. */
/* .stories-cell { align-self: center !important; } */

/* Bottom row cells: fill the row height, but don't squash contents */
.favorites-cell,
.current-cell {
  align-self: stretch !important;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

/* Black boxes: normal block layout, no forced 100% height or grid centering */
.favorites-strip,
.current-strip {
  flex: 1 1 auto;
  display: block !important;                 /* REVERT: not grid */
  padding: clamp(8px, 1.2vw, 12px) !important; /* match Stories padding */
  box-sizing: border-box;
}

/* Favorites grid: tidy, centered, but not stretching container height */
.favorites-strip .favorites-grid {
  display: grid !important;
  grid-template-columns: repeat(5, minmax(0, 1fr)) !important;
  gap: clamp(8px, 1.6vw, 16px) !important;
  align-items: center !important;
  justify-items: center !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* Heatmap container: plain block so the SVG can size itself */
.current-strip .current-grid {
  display: block !important;                 /* REVERT: not grid */
  margin: 0 !important;
  padding: 0 !important;
}

/* Heatmap sizing: fill width naturally (no forced height) */
.reading-heatmap { width: 100%; display: block; }
.reading-heatmap svg { width: 100%; height: auto; display: block; }

/* Keep the section titles consistent with Stories */
.favorites-cell .section-title,
.current-cell .section-title {
  margin: 0 0 8px !important;
}

